function RegistrarCarta(){var e=new FormData,t=$("#modalRegCarta :input").serializeArray();e.append("btnGuardarCarta","btnGuardarCarta"),Array.prototype.forEach.call(t,function(t){e.append(t.name,t.value)}),$.ajax({url:"services/cartadia/cartadia-post.php",type:"POST",dataType:"json",data:e,contentType:!1,processData:!1,success:function(e){createSnackbar(e.titulomsje),"0"!=e.rpta&&(closeCustomModal("#modalRegCarta"),ListarCartas("lista","1"))},error:function(e){console.log(e)}})}function LimpiarPacks(){$("#txtNombreGrupo").val(""),$("#ddlMoneda")[0].selectedIndex=0,$("#txtPrecioVigente").val("0.00")}function LimpiarCategoria(){$("#hdIdCategoria").val("0"),$("#txtNombreCategoria").val("").focus()}function LimpiarArticulo(){$("#hdIdArticulo").val("0"),$("#txtCodigo").val(""),$("#txtDescripcion").val(""),$("#txtPrecioArticulo").val("0"),$("#chkTieneReceta")[0].checked=!0,$("#chkEsAgregado")[0].checked=!1,$("#txtTiempoPreparacionMenu").val("0"),$("#txtTiempoPreparacionCarta").val("0"),$("#txtPrecioArticuloMenu").val("0.00"),$("#txtPrecioArticuloCarta").val("0.00"),$("#txtNroPorciones").val("1"),$("#lblTotalCostoReceta").text("S/. 0.00"),$("#txtNombreArticulo").val("").focus()}function addValidFormCategoria(){$("#txtNombreCategoria").rules("add",{required:!0,maxlength:150,remote:{url:"services/categorias/check-nombre-categoria_articulo.php",type:"POST",data:{idempresa:function(){return $("#hdIdEmpresa").val()},idcentro:function(){return $("#hdIdCentro").val()},idregistro:function(){return $("#hdIdCategoria").val()}}}})}function removeValidFormCategoria(){$("#txtNombreCategoria").rules("remove")}function addValidFormArticulo(){$("#txtNombre").rules("add",{required:!0,maxlength:150,remote:{url:"services/productos/check-nombre.php",type:"POST",data:{idempresa:function(){return $("#hdIdEmpresa").val()},idcentro:function(){return $("#hdIdCentro").val()},idregistro:function(){return $("#hdIdArticulo").val()}}}})}function checkAllTable(e,t){var a=document.querySelectorAll(e);null!=a&&([].forEach.call(a,function(a){var i=a.getElementsByClassName("filled-in");if("#tableSeccion tbody tr"==e){var o=a.getElementsByClassName("seccion");t===!0?o[0].parentNode.classList.remove("is-disabled"):o[0].parentNode.classList.add("is-disabled"),habilitarControl(o[0],t)}else{var n=a.getElementsByClassName("stock"),r=a.getElementsByClassName("precio");t===!0?(n[0].parentNode.classList.remove("is-disabled"),r[0].parentNode.classList.remove("is-disabled")):(n[0].parentNode.classList.add("is-disabled"),r[0].parentNode.classList.add("is-disabled")),habilitarControl([n[0],r[0]],t)}i[0].checked=t}),t?($(a).addClass("selected is-selected"),"#tableSeccion tbody tr"!=e&&($("#btnSelectAll").addClass("hide"),$("#btnUnSelectAll").removeClass("hide"))):($(a).removeClass("selected is-selected"),"#tableSeccion tbody tr"!=e&&($("#btnSelectAll").removeClass("hide"),$("#btnUnSelectAll").addClass("hide"))))}function removeSelectionInMenu(){var e,t="";"EDIT"==$("#hdModeMenuEdit").val()?(e=gvArticuloMenu,t="#gvArticuloMenu"):(e=gvArticulo,t="#gvArticulo"),"true"==$("#hdAsignacionMenu").val()?e.showAppBar(!1,"edit"):e.removeSelection(),checkAllTable(t+" tbody tr",!1)}function EliminarAsignados(){var e=new FormData,t=$("#hdTipoCarta").val(),a="#gvArticuloMenu .table-responsive-vertical :input",i=$(a).serializeArray();e.append("btnEliminarAsignados","btnEliminarAsignados"),e.append("hdTipoCarta",t),Array.prototype.forEach.call(i,function(t){e.append(t.name,t.value)}),$.ajax({type:"POST",url:"services/cartadia/cartadia-post.php",cache:!1,dataType:"json",data:e,contentType:!1,processData:!1,success:function(e){createSnackbar(e.titulomsje),$("#btnUnSelectAll").trigger("click"),"00"==$("#hdTipoCarta").val()?ListarArticulos_Carta("1"):showMenuWhenView()},error:function(e){console.log(e)}})}function buildRowReceta(e,t,a,i,o,n,r,l,d,s){var c="";return c="<tr>",c+='<td class="nombreInsumo">'+i,c+='<input type="hidden" name="receta['+fila_Receta+'][hdIdreceta]" id="hdIdreceta'+fila_Receta+'" value="'+fila_Receta+'" />',c+='<input type="hidden" name="receta['+fila_Receta+'][hdIdinsumo]" id="hdIdinsumo'+fila_Receta+'" value="'+a+'" />',c+='<input type="hidden" name="receta['+fila_Receta+'][hdIdunidadmedida]" id="hdIdunidadmedida'+fila_Receta+'" value="'+t+'" />',c+='<input type="hidden" class="hdCostoInsumo" name="receta['+fila_Receta+'][hdCostoInsumo]" id="hdCostoInsumo'+fila_Receta+'" value="'+n+'" />',c+='<input type="hidden" class="hdCostoReceta" name="receta['+fila_Receta+'][hdCostoReceta]" id="hdCostoReceta'+fila_Receta+'" value="'+Number(s).toFixed(3)+'" />',c+='<input class="avgxporcion" type="hidden" name="receta['+fila_Receta+'][txtPromedioPorcion]" id="txtPromedioPorcion'+fila_Receta+'" value="'+Number(d).toFixed(3)+'">',c+="</td>",c+='<td class="unidadmedida">'+o+"</td>",c+='<td><div class="mdl-textfield mdl-js-textfield full-size no-padding"><input class="mdl-textfield__input align-right cantidad" type="text" name="receta['+fila_Receta+'][txtCantidad]" id="txtCantidad'+fila_Receta+'" value="'+Number(r).toFixed(3)+'"><label class="mdl-textfield__label" for="txtCantidad'+fila_Receta+'"></label></div></td>',c+='<td class="text-right cell-avgxporcion">'+Number(d).toFixed(3)+"</td>",c+='<td class="text-right costoreceta">'+Number(s).toFixed(3)+"</td>",c+='<td class="text-center"><a class="padding5 mdl-button mdl-button--icon center-block tooltipped" data-placement="left" data-toggle="tooltip" title="Eliminar" href="#" data-action="delete"><i class="material-icons">&#xE872;</i></a></td>',c+="</tr>"}function ListarReceta(e,t){$.ajax({type:"GET",url:"services/recetas/recetas-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"1",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),idproducto:e,tipomenudia:t},success:function(e){var t="",a=e.length,i=0;if(fila_Receta=0,a>0)for(;fila_Receta<a;)t+=buildRowReceta(e[fila_Receta].td_idreceta,e[fila_Receta].tm_idunidadmedida,e[fila_Receta].tm_idinsumo,e[fila_Receta].tm_nombre,e[fila_Receta].UnidadMedida,e[fila_Receta].tm_costoPromedio,e[fila_Receta].td_cantidad,e[fila_Receta].td_nroporciones,e[fila_Receta].td_avgxporcion,e[fila_Receta].td_costoreceta),i+=Number(e[fila_Receta].td_costoreceta),++fila_Receta;$("#tableReceta tbody").html(t),registerScriptMDL("#tableReceta .mdl-js-textfield"),$(".tooltipped").tooltip({delay:50}),$("#lblTotalCostoReceta").text("S/. "+i.toFixed(2))},error:function(e){console.log(e)}})}function addInsumoToReceta(){var e=0,t="",a=pnlInsumo.getTagElements(),i=a.length;if(i>0){for(;e<i;){var o=a[e],n=o.getAttribute("data-idinsumo"),r=o.getAttribute("data-idunidadmedida"),l=(o.getAttribute("data-idpresentacion"),o.getAttribute("data-costoinsumo")),d=o.getElementsByClassName("taggle_text")[0],s=d.innerHTML,c=s.toString().split("|"),u=c[0],p=c[1];t+=buildRowReceta(0,r,n,u,p,l,0,0,0,0),++e,fila_Receta+=e}$("#tableReceta tbody").append(t),registerScriptMDL("#tableReceta .mdl-js-textfield"),pnlInsumo.removeAll()}}function insumoTag_setValues(e,t,a){var i=t.getElementsByClassName("descripcion")[0];_idinsumo=t.getAttribute("data-idmodel"),UnidadMedida.id=a.getAttribute("data-idunidadmedida"),UnidadMedida.simbolo=a.getAttribute("data-simbolo"),UnidadMedida.idpresentacion=a.getAttribute("data-idpresentacion"),pnlInsumo.add(i.textContent+" | "+a.textContent),e.addClass("hide")}function ListarInsumos(e){var t=hrowSearchInsumo.find(".gridview"),a=t.find(".collection"),i=t.find(".empty-temp"),o=0,n="",r=e.length;if(r>0){for(;o<r;){var l=e[o].tm_idinsumo;n+='<li class="collection-item avatar no-border dato" data-idmodel="'+l+'">',n+='<i class="icon-expand material-icons circle white-text">&#xE8A0;</i>',n+='<span class="title descripcion grey-text text-darken-4">'+e[o].nombre_insumo+"</span>",n+="<div>",n+='<span data-idunidadmedida="'+e[o].tm_idunidadmedida+'" data-costoinsumo="'+e[o].costo_insumo+'" class="badges_subitem right padding5 grey lighten-2 grey-text text-darken-4 margin5">'+e[o].simbolo_unidad+"</span>",n+="</div>",n+="</li>",++o}a.html(n),a.removeClass("hide"),i.addClass("hide")}else a.addClass("hide"),i.removeClass("hide")}function getDataMenu(e){var t=$("#hdModeMenuView").val();"VIEW-LIST-MENU"==t?ListarArticulos_Menu("1",0,e):"VIEW-LIST-PACK"==t?ListarPacks_viewlist(e):"VIEW-LIST-CARTA"==t&&ListarCartas("lista",e)}function getDataByReference(e){if($("#hdAsignacionMenu").val("false"),"#gvMenu"==e||"#gvCarta"==e){var t="";$("#hdModeMenuEdit").val("EDIT"),btnNuevo.addClass("hide"),$("#pnlMenuCarta").removeClass("hide"),$("#btnProgram").addClass("show-in-select").removeClass("hide"),$("#btnGoToPacks").removeClass("show-in-select").addClass("hide"),"#gvMenu"==e?($("#hdTipoCarta").val("03"),$("#lblTitulo, #btnNuevaCarta").addClass("hide"),$(".view-button, #btnShowCalendar, #optIndividual").removeClass("hide"),$('.view-button[data-action="view-list"]').hasClass("active")?($("#titleMenuCarta, #btnShowSubOpciones").addClass("hide"),t="VIEW-LIST-MENU"):($("#titleMenuCarta, #btnShowSubOpciones").removeClass("hide"),t="VIEW-LIST-PACK")):"#gvCarta"==e&&($("#hdTipoCarta").val("00"),$(".view-button, #btnShowCalendar, #optIndividual").addClass("hide"),$("#lblTitulo, #titleMenuCarta, #btnShowSubOpciones, #btnNuevaCarta").removeClass("hide"),t="VIEW-LIST-CARTA"),$("#hdModeMenuView").val(t),getDataMenu("1")}else btnNuevo.removeClass("hide"),$("#btnNuevaCarta").addClass("hide"),"#gvCategoria"==e?($("#gvArticuloPack").addClass("hide"),$("#btnGoToPacks").removeClass("show-in-select").addClass("hide"),$("#btnProgram").removeClass("show-in-select").addClass("hide"),habilitarLink("#btnMoreSites",!0),0==$(e+" .dato").length&&ListarCategorias("1")):"#pnlListado"==e||"#gvArticulo"==e?($("#hdModeMenuEdit").val("ART"),$("#hdAsignacionMenu").val("false"),$("#btnGoToPacks").addClass("show-in-select").removeClass("hide"),$("#btnProgram").removeClass("show-in-select").addClass("hide"),habilitarLink("#btnMoreSites",!0),0==$(e+" .dato").length&&ListarArticulos("1")):"#gvPacks"==e&&($("#btnProgram").removeClass("show-in-select").addClass("hide"),habilitarLink("#btnMoreSites",!0),$("#btnGoToPacks").removeClass("show-in-select").addClass("hide"),0==$(e+" .dato").length&&ListarPacks("#gvPacks","1"))}function enableListCategoria(e,t){[].forEach.call(e,function(e){t?e.removeAttribute("onclick"):e.setAttribute("onclick","return false;")})}function Nuevo(){$("#gvCategoria").is(":visible")?GoToEditCategoria("0"):$("#gvPacks").is(":visible")?GoToEditPack("0"):GoToEditArticulo("0")}function FiltrarPorIdItem(e){$("#hdIdCategoria").val(e),navigateSubSite("#gvArticulo","Artículos"),ListarArticulos("1")}function AsignacionGrupoArticulo(){var e="#gvPacksAsignacion .dato.selected";indexList=0,$(e+" .progress").removeClass("hide"),elemsSelected=document.querySelectorAll(e),AsignacionGrupoArticulo_transferencia(elemsSelected[0])}function AsignacionGrupoArticulo_transferencia(e){var t=new FormData,a="0",i=document.querySelectorAll("#gvArticulo .dato.selected"),o=e.querySelector(".progress .determinate"),n=e.getAttribute("data-idmodel"),r=[].map.call(i,function(e){return e.getAttribute("data-idmodel")}).join(",");if(e.classList.contains("select-in-details")){var l=e.querySelector(".list-options li.subitem-selected");a=l.getAttribute("data-idseccion")}o.classList.add("teal","lighten-1"),t.append("btnAsignarGrupoProducto","btnAsignarGrupoProducto"),t.append("listaProductos",r),t.append("hdIdEmpresa",$("#hdIdEmpresa").val()),t.append("hdIdCentro",$("#hdIdCentro").val()),t.append("hdIdPack",n),t.append("hdIdSeccion",a),$.ajax({url:"services/grupos/grupos-post.php",type:"POST",dataType:"json",data:t,cache:!1,contentType:!1,processData:!1,success:function(e){++indexList,progressError=!1,o.classList.remove("teal","lighten-1"),o.classList.add("light-green"),o.style.width="100%",intervalProgress.isRunning()&&intervalProgress.stop(),indexList<=elemsSelected.length-1?AsignacionGrupoArticulo_transferencia(elemsSelected[indexList]):(completado=!0,createSnackbar(e.titulomsje),"0"!=e.rpta&&($("#btnSearch, #btnOpciones").removeClass("hide"),$("#gvPacksAsignacion .progress").addClass("hide"),$("#gvPacksAsignacion .subitem-selected").removeClass("subitem-selected"),$("#btnRecursosBack").off("click",listenerDefaultBackButton),$("#btnRecursosBack").on("click",listenerAsignaPackInBack),gvPacksAsignacion.removeSelection(),gvArticulo.removeSelection(),$("#gvPacksAsignacion").removeClass("custom"),getDataByReference("#gvArticulo")))},beforeSend:function(){completado=!1,intervalProgress.start()},complete:function(){progress=0,progressError&&0==completado&&setTimeout(function(){intervalProgress.isRunning()&&intervalProgress.stop(),o.style.width="100%",AsignacionGrupoArticulo_transferencia(elemsSelected[indexList])},1e4)},error:function(e){progress=0,o.classList.remove("teal","lighten-1"),o.classList.add("red"),progressError=!0,console.log(e)}})}function AsignarArticulosMenu(){var e=new FormData,t=$("#hdModeMenuEdit").val(),a=$("#hdTipoCarta").val(),i="0",o="NEW"==t?"#gvArticulo":"#gvArticuloMenu";o+=" .table-responsive-vertical :input","00"==a&&(i=$("#optSubMenu").find(".active").attr("data-idmodel"));var n=$(o).serializeArray();e.append("btnAsignarArticulos","btnAsignarArticulos"),e.append("hdTipoCarta",a),e.append("hdEditMode",t),e.append("hdIdEmpresa",$("#hdIdEmpresa").val()),e.append("hdIdCentro",$("#hdIdCentro").val()),e.append("hdIdCarta",i),e.append("hdFecha",$("#hdFecha").val()),Array.prototype.forEach.call(n,function(t){e.append(t.name,t.value)}),$.ajax({type:"POST",url:"services/cartadia/cartadia-post.php",cache:!1,dataType:"json",data:e,contentType:!1,processData:!1,success:function(e){createSnackbar(e.titulomsje),$("#btnUnSelectAll").trigger("click"),"00"==$("#hdTipoCarta").val()?ListarArticulos_Carta("1"):showMenuWhenView(),ListarArticulos("1")},error:function(e){console.log(e)}})}function GetInfoPeriod(e,t){$.ajax({type:"GET",url:"services/productos/productos-getperiods.php",cache:!1,dataType:"json",data:{idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),idproducto:e,tipomenu:t},success:function(e){e.length>0&&("03"==t?$("#txtTiempoPreparacionMenu").val(e[0].td_tiempo):$("#txtTiempoPreparacionCarta").val(e[0].td_tiempo))},error:function(e){console.log(e)}})}function GetInfoPrice(e,t){$.ajax({type:"GET",url:"services/productos/productos-getprices.php",cache:!1,dataType:"json",data:{idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),idproducto:e,tipomenu:t},success:function(e){e.length>0&&("03"==t?$("#txtPrecioArticuloMenu").val(e[0].td_precio):$("#txtPrecioArticuloCarta").val(e[0].td_precio))},error:function(e){console.log(e)}})}function GoToEditArticulo(e){var t="#pnlRegArticulo";$("#hdIdArticulo").val("0"),hdFoto.value="no-set",precargaExp(t,!0),$("#tableReceta tbody").html(""),$("#pnlTimePrepMenu").removeClass("hide"),$("#pnlTimePrepCarta").addClass("hide"),$("#txtTiempoPreparacionMenu").val("0.00"),$("#txtTiempoPreparacionCarta").val("0.00"),resetFoto("new"),panelListado.addClass("hide"),pnlRegArticulo.removeClass("hide"),btnNuevo.addClass("hide"),LimpiarArticulo(),$("#chkTieneReceta")[0].checked=!0,"0"==e?(ListarCategorias_Combo("0"),ListarAreasTrabajo("0"),ListarUnidadMedida_Combo("#ddlUnidadMedidaReg","0"),precargaExp(t,!1)):$.ajax({type:"GET",url:"services/productos/productos-getdetails.php",cache:!1,dataType:"json",data:"id="+e,success:function(e){var a=e.length,i="";if(a>0){var o=e[0].tm_idproducto,n=e[0].tm_foto,r=1==e[0].tm_tienereceta,l=1==e[0].tm_esagregado;"no-set"!=n&&(i=n.replace("_o","_s640")),$("#hdIdArticulo").val(o),$("#txtCodigo").val(e[0].tm_codigo),$("#txtDescripcion").val(e[0].td_contenido),$("#txtPrecioArticulo").val(e[0].tm_precioVenta),$("#txtNroPorciones").val(e[0].tm_nroporciones),chkTieneReceta[0].checked=r,chkEsAgregado[0].checked=l,helperReceta.text(1==r?"SI":"NO"),helperAgregado.text(1==l?"SI":"NO"),$("#txtNombreArticulo").val(e[0].tm_nombre).focus(),Materialize.updateTextFields(),ListarCategorias_Combo(e[0].tm_idcategoria),ListarAreasTrabajo(e[0].tm_idareadespacho),ListarUnidadMedida_Combo("#ddlUnidadMedidaReg",e[0].tm_idunidadmedida),"no-set"==n?(imgFoto.classList.add("hide"),imgFoto.setAttribute("data-src","none")):(setFoto(i),imgFoto.classList.remove("hide")),hdFoto.value=n,r?(ListarReceta(o,"03"),GetInfoPeriod(o,"03"),GetInfoPeriod(o,"00"),GetInfoPrice(o,"03"),GetInfoPrice(o,"00")):(counter_presentacion=0,ListarPresentaciones(o)),MostrarSelectUnidadMedida(r)}precargaExp(t,!1)},error:function(e){console.log(e)}})}function GuardarArticulo(){precargaExp("#pnlRegArticulo",!0);var e=btnChooseReceta.attr("data-tiporeceta"),t=fileValue,a=new FormData,i=$("#pnlRegArticulo :input").serializeArray();a.append("btnAplicarArticulo","btnAplicarArticulo"),a.append("TipoMenuDia",e),a.append("hdIdEmpresa",$("#hdIdEmpresa").val()),a.append("hdIdCentro",$("#hdIdCentro").val()),a.append("archivo",t),Array.prototype.forEach.call(i,function(e){a.append(e.name,e.value)}),$.ajax({type:"POST",url:"services/productos/productos-post.php",cache:!1,dataType:"json",data:a,contentType:!1,processData:!1,success:function(e){precargaExp("#pnlRegArticulo",!1),createSnackbar(e.titulomsje),Number(e.rpta)>0&&(pnlRegArticulo.addClass("hide"),panelListado.removeClass("hide"),ListarArticulos("1"))},error:function(e){console.log(e)}})}function GoToEditPack(e){var t="#modalRegPack";hdIdPack.val("0"),precargaExp(t,!0),LimpiarPacks(),openModalCallBack(t,function(){ListarSeccionesPack(e),"0"==e?(precargaExp(t,!1),$("#txtNombreGrupo").focus()):$.ajax({url:"services/grupos/grupos-search.php",cache:!1,type:"GET",dataType:"json",data:{tipobusqueda:"4",id:e},success:function(e){e.length>0&&(hdIdPack.val(e[0].tm_idgrupoarticulo),$("#ddlMoneda").val(e[0].tm_idmoneda),$("#txtPrecioVigente").val(e[0].td_precio),$("#txtNombreGrupo").val(e[0].tm_nombre).focus()),precargaExp(t,!1)},error:function(e){console.log(e)}})})}function GuardarGrupo(){var e=new FormData,t=$("#modalRegPack :input").serializeArray();e.append("btnAplicarGrupo","btnAplicarGrupo"),e.append("hdIdEmpresa",$("#hdIdEmpresa").val()),e.append("hdIdCentro",$("#hdIdCentro").val()),Array.prototype.forEach.call(t,function(t){e.append(t.name,t.value)}),$.ajax({type:"POST",url:"services/grupos/grupos-post.php",cache:!1,dataType:"json",data:e,contentType:!1,processData:!1,success:function(e){createSnackbar(e.titulomsje),Number(e.rpta)>0&&(closeCustomModal("#modalRegPack"),ListarPacks("#gvPacks","1"))},error:function(e){console.log(e)}})}function createItemCategoria(e,t,a,i){var o="",n="",r="",l="",d="",s="",c="",u="";return"0"==t?(n+='<a data-action="cancel" class="option-edit margin20 padding5 mdl-button mdl-button--icon tooltipped place-top-right grey-text" href="#" data-delay="50" data-position="bottom" data-tooltip="Eliminar"><i class="material-icons">&#xE5CD;</i></a>',l=" selected",d=" checked",s=" disabled",c=" hide",u="",r='<a data-action="save-changes" class="option-edit margin20 padding5 mdl-button mdl-button--icon tooltipped place-top-left green-text" href="#" data-delay="50" data-position="bottom" data-tooltip="Guardar"><i class="material-icons">&#xE5CA;</i></a>'):(n+='<div class="grouped-buttons place-bottom-right padding5">',n+='<a class="padding5 mdl-button mdl-button--icon tooltipped" href="#" data-action="more" data-delay="50" data-position="bottom" data-tooltip="M&aacute;s"><i class="material-icons">&#xE5D4;</i></a>',n+='<ul class="dropdown">',n+='<li><a href="#" data-action="goto">Ver art&iacute;culos</a></li>',n+='<li><a href="#" data-action="delete">Eliminar</a></li>',n+="</div>",l="",d="",s="",c="",u=" hide",r='<label class="mdl-input-js mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect check-filled" for="chkItem'+i+'"><input name="chkItem[]" type="checkbox" id="chkItem'+i+'" class="mdl-checkbox__input" value="'+t+'"><span class="mdl-checkbox__label"></span></label>'),o='<li data-idmodel="'+t+'" class="mini-collection-item avatar dato pos-rel grey lighten-5 padding-right60'+l+'" data-baselement="'+e+'">',o+=r,o+='<div class="circle">'+(a.length>0?a[0]:"")+"</div>",o+='<h5 class="title descripcion all-height v-align-middle no-margin'+c+'">'+a+"</h5>",o+='<div class="mdl-input-js mdl-textfield mdl-js-textfield full-size no-padding'+u+'"><input class="mdl-textfield__input categoria" type="text" name="seccion['+i+'][txtNombreCategoria]" id="txtNombreCategoria'+i+'" value="'+a+'"><label class="mdl-textfield__label" for="txtNombreCategoria'+i+'"></label></div>',o+=n+"</li>"}function ListarCategorias(e){var t="#gvCategoria",a=t+" .gridview-content",i="";precargaExp("#pnlListado",!0),$.ajax({type:"GET",url:"services/categorias/categoria-search.php",cache:!1,dataType:"json",data:{tipobusqueda:1,idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),criterio:i,pagina:e},success:function(i){var o=0,n=i.length,r="";if(n>0){for(;o<n;){var l=i[o].tm_idcategoria;r+='<li data-idmodel="'+l+'" class="list-group-item dato" data-baselement="'+t+'">',r+='<input name="chkItem[]" type="checkbox" class="filled-in" value="'+l+'" id="chkItem'+o+'" /><label for="chkItem'+o+'" class="check-filled"></label>',r+=i[o].tm_nombre,r+='<div class="grouped-buttons place-bottom-right padding5">',r+='<a class="padding5 mdl-button mdl-button--icon tooltipped" href="#" data-action="more" data-delay="50" data-position="bottom" data-tooltip="M&aacute;s"><i class="material-icons">&#xE5D4;</i></a>',r+='<ul class="dropdown">',r+='<li><a href="#" data-action="edit">Editar</a></li>',r+='<li><a href="#" data-action="delete">Eliminar</a></li>',r+="</div>",r+="</li>",++o}gvCategoria.currentPage(gvCategoria.currentPage()+1),"1"==e?$(a).html(r):$(a).append(r),registerScriptMDL("#gvCategoria .mdl-input-js")}else"1"==e&&$(a).html("<h2>No se encontraron resultados.</h2>");precargaExp("#pnlListado",!1)},error:function(e){console.log(e)}})}function ListarCategorias_Combo(e){$.ajax({type:"GET",url:"services/categorias/categoria-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"1",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val()},success:function(t){var a="",i=0,o=t.length;if(o>0)for(;i<o;){var n=e==t[i].tm_idcategoria?" selected":"";a+="<option"+n+' value="'+t[i].tm_idcategoria+'">'+t[i].tm_nombre+"</option>",++i}else a='<option value="0">No existen categor&iacute;as registradas.</option>';$("#ddlCategoriaReg").html(a)},error:function(e){console.log(e)}})}function ListarAreasTrabajo(e){$.ajax({type:"GET",url:"services/areas/areas-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"3",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val()},success:function(t){var a="",i=0,o=t.length;if(o>0)for(;i<o;){var n=e==t[i].tp_idarea?" selected":"";a+="<option"+n+' value="'+t[i].tp_idarea+'">'+t[i].tp_nombre+"</option>",++i}else a='<option value="0">No hay &aacute;reas de trabajo registradas.</option>';$("#ddlAreaDespacho").html(a)},error:function(e){console.log(e)}})}function ListarPresentacion_Combo(e){$.ajax({type:"GET",url:"services/presentacion/presentacion-search.php",cache:!1,dataType:"json",data:{tipo:"L",tipobusqueda:"1",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val()},success:function(t){var a="",i=0,o=t.length;if(o>0)for(;i<o;){var n=e==t[i].tm_idpresentacion?" selected":"";a+="<option"+n+' value="'+t[i].tm_idpresentacion+'">'+t[i].tm_nombre+"</option>",++i}else a='<option value="0">No hay presentaciones registradas.</option>';$("#ddlPresentacion").html(a)},error:function(e){console.log(e)}})}function ListarUnidadMedida_Combo(e,t){$.ajax({type:"GET",url:"services/unidadmedida/unidadmedida-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"1",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val()},success:function(a){var i="",o=0,n=a.length;if(n>0)for(;o<n;){var r=t==a[o].tm_idunidadmedida?" selected":"";i+="<option"+r+' value="'+a[o].tm_idunidadmedida+'">'+a[o].tm_nombre+"</option>",++o}else i='<option value="0">No hay unidades de medida registradas.</option>';$(e).html(i)},error:function(e){console.log(e)}})}function GoToEditCategoria(e){var t="#modalRegCategoria";precargaExp(t,!0),addValidFormCategoria(),openModalCallBack(t,function(){LimpiarCategoria(),"0"==e?precargaExp(t,!1):$.ajax({url:"services/categorias/categoria-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"2",id:e},success:function(e){e.length>0&&($("#hdIdCategoria").val(e[0].tm_idcategoria),$("#txtNombreCategoria").val(e[0].tm_nombre).focus()),precargaExp(t,!1)},error:function(e){console.log(e)}})})}function buildArticulos_edicion(e,t){var a="",i=t.length;if(i>0)for(var o=0;o<i;)a+='<div class="demo-card-square mdl-card dato articulo mdl-shadow--2dp mdl-cell mdl-cell--2-col mdl-cell--2-col-tablet mdl-cell--2-col-phone" data-idmodel="'+t[o].tm_idproducto+'">',a+='<input name="chkItem[]" type="checkbox" class="hide" value="'+t[o].tm_idproducto+'" />',a+='<div class="mdl-card__media pos-rel">',a+='<i class="icon-select centered material-icons white-text circle">done</i>',"no-set"!=t[o].tm_foto&&(a+='<img src="'+t[o].tm_foto.replace("_o","_s225")+'" width="100%" height="140px" border="0" alt="">'),a+="</div>",a+='<div class="layer-select"></div>',a+='<div class="mdl-card__title">',a+='<div class="grouped-buttons mdl-grid mdl-grid--no-spacing full-size no-margin pos-rel">',a+='<div class="mdl-cell mdl-cell--9-col mdl-cell--3-col-phone">',a+='<h5 class="text-ellipsis" title="'+t[o].tm_nombre+'">'+t[o].tm_nombre+"</h5>",a+="</div>",a+='<div data-action="more" class="mdl-cell mdl-cell--3-col mdl-cell--1-col-phone"><a href="#" class="mdl-button mdl-button--icon right tooltipped" data-delay="50" data-position="bottom" data-tooltip="M&aacute;s"><i class="material-icons">&#xE5D4;</i></a></div>',a+='<ul class="dropdown">',a+='<li><a href="#" data-action="edit">Editar</a></li>',a+='<li><a href="#" data-action="delete">Eliminar</a></li>',a+="</ul>",a+="</div>",a+="</div>",a+="</div>",++o;else"1"==e&&(a="<h2>No se encontraron resultados.</h2>");return a}function buildArticulos_asignacion(e,t){var a="",i=t.length;if(i>0)for(var o=0;o<i;)a+="<tr>",a+='<td><input type="checkbox" class="filled-in" id="chkDetalle'+o+'" name="mc_articulo['+o+'][chkDetalle]" /><label for="chkDetalle'+o+'"></label></td>',a+='<td data-title="Articulo" class="v-align-middle"><input name="mc_articulo['+o+'][iddetalle]" type="hidden" id="iddetalle'+o+'" value="0" /><input name="mc_articulo['+o+'][idproducto]" type="hidden" id="idproducto'+o+'" value="'+t[o].tm_idproducto+'" />'+t[o].tm_nombre+"</td>",a+='<td data-title="Stock">',a+='<div class="mdl-input-js mdl-textfield mdl-js-textfield full-size no-padding"><input class="mdl-textfield__input align-right no-margin stock" type="number" step="any" name="mc_articulo['+o+'][stock]" id="stock'+o+'" value="10" disabled><label class="mdl-textfield__label" for="stock'+o+'"></label></div>',a+="</td>",a+='<td data-title="Precio">',a+='<div class="mdl-input-js mdl-textfield mdl-js-textfield full-size no-padding"><input class="mdl-textfield__input align-right no-margin precio" type="number" step="any" name="mc_articulo['+o+'][precio]" id="precio'+o+'" value="'+Number(t[o].td_precio).toFixed(2)+'" disabled><label class="mdl-textfield__label" for="precio'+o+'"></label></div>',a+="</td>",a+="</tr>",++o;else"1"==e&&(a="<h2>No se encontraron resultados.</h2>");return a}function ListarArticulos(e){var t="#gvArticulo",a=t+" > .gridview-content > .mdl-grid",i=$("#hdAsignacionMenu").val();"true"==i?($(t+" .gridview-content").addClass("hide"),$(t+" .table-responsive-vertical").removeClass("hide"),a=t+" .table-responsive-vertical tbody",tipobusqueda="05"):($(t+" .gridview-content").removeClass("hide"),$(t+" .table-responsive-vertical").addClass("hide"),tipobusqueda="00"),precargaExp("#pnlListado",!0),$.ajax({url:"services/productos/productos-search.php",type:"GET",dataType:"json",data:{tipobusqueda:tipobusqueda,idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),idcategoria:$("#hdIdCategoria").val(),criterio:$("#txtSearch").val(),fecha:$("#hdFecha").val(),tipomenudia:$("#hdTipoCarta").val(),pagina:e},success:function(t){var o="";o="true"==i?buildArticulos_asignacion(e,t):buildArticulos_edicion(e,t),gvArticulo.currentPage(gvArticulo.currentPage()+1),"1"==e?$(a).html(o):$(a).append(o),"true"==i&&registerScriptMDL("#gvArticulo .mdl-input-js"),precargaExp("#pnlListado",!1)},error:function(e){console.log(e)}})}function ListarPacks(e,t){precargaExp("#pnlListado",!0),$.ajax({type:"GET",url:"services/grupos/grupos-search.php",cache:!1,dataType:"json",data:{tipobusqueda:55,idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),criterio:"",pagina:t},success:function(a){var i=0,o="",n=0,r=e+" .gridview-content",l=_.groupBy(a,function(e){return e.tm_idgrupoarticulo+"#"+e.tm_nombre}),d=_.map(l,function(e){return{tm_idgrupoarticulo:e[0].tm_idgrupoarticulo,tm_nombre:e[0].tm_nombre,tm_idmoneda:e[0].tm_idmoneda,tm_simbolo:e[0].tm_simbolo,td_precio:e[0].td_precio,list_secciones:e}}),s=d.length;if(s>0){for(;i<s;){var c=0,u=d[i].tm_idgrupoarticulo,p=d[i].list_secciones;1==p.length?0==p[0].td_nombreseccion.trim().length&&(n=0):n=p.length;var m=n>0?"select-in-details":"select-in-item",g="#gvPacks"==e?" mdl-cell--2-col":" mdl-cell--12-col";if(o+='<div data-idmodel="'+u+'" data-idMoneda="'+d[i].tm_idmoneda+'" class="dato card mdl-cell'+g+" mdl-shadow--2dp left "+m+'" data-baselement="'+e+'">',o+='<input type="checkbox" style="display:none;" name="chkItem[]" value="'+u+'">',o+='<i class="icon-select place-top-right margin10 material-icons circle white-text">done</i><div class="layer-select"></div>',o+='<div class="card-content">',o+='<span class="card-title descripcion">'+d[i].tm_nombre+"</span>",n>0){for(o+='<ul class="list-options">';c<n;)o+='<li data-idseccion="'+p[c].tp_idseccionpack+'">'+p[c].td_nombreseccion+"</li>",++c;o+="</ul>"}o+='<div class="progress hide"><div class="determinate" style="width: 0%"></div></div>',o+="</div>",o+='<div class="card-action">',o+='<h4 class="black-text no-margin"><span class="moneda">'+d[i].tm_simbolo+' </span><span class="precio">'+Number(d[i].td_precio).toFixed(2)+"</span></h4>",o+="</div>","#gvPacks"==e&&(o+='<div class="grouped-buttons place-bottom-right padding5 margin5">',o+='<a class="padding5 mdl-button mdl-button--icon tooltipped" href="#" data-action="more" data-delay="50" data-position="bottom" data-tooltip="M&aacute;s"><i class="material-icons">&#xE5D4;</i></a>',o+='<ul class="dropdown">',o+='<li><a href="#" data-action="edit">Editar</a></li>',o+='<li><a href="#" data-action="delete">Eliminar</a></li>',o+="</ul>",o+="</div>"),o+="</div>",++i}gvPacks.currentPage(gvPacks.currentPage()+1),"1"==t?$(r).html(o):$(r).append(o),"#gvPacksAsignacion"!=e&&initMasonry(r,".mdl-cell--2-col",".dato")}else"1"==t&&$(r).html("<h2>No se encontraron resultados.</h2>");precargaExp("#pnlListado",!1)},error:function(e){console.log(e)}})}function ListarPacks_viewlist(e){var t="#optSubMenu";$.ajax({type:"GET",url:"services/grupos/grupos-search.php",cache:!1,dataType:"json",data:{tipobusqueda:5,idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),criterio:"",pagina:e},success:function(a){var i=0,o=a.length,n="";if(o>0){for(;i<o;)n+='<li><a class="pos-rel padding20 grey-text text-darken-4 row no-margin" data-idmodel="'+a[i].tm_idgrupoarticulo+'" data-type="menu" href="#">',n+='<div class="col s6 v-align-middle">'+a[i].tm_nombre+"</div>",n+='<div class="col s6 v-align-middle">'+a[i].tm_simbolo+" "+a[i].td_precio+"</div>",n+="</a></li>",++i;paginaPack_lista+=1,$("#hdPageGrupo_lista").val(paginaPack_lista),"1"==e?($(t).html(n),$("#pnlSubMenu").find("a:first").trigger("click")):$(t).append(n)}else"1"==e&&$(t).html("")},error:function(e){console.log(e)}})}function ListarSeccionesPack(e){var t="#tableSeccion tbody";$.ajax({type:"GET",url:"services/grupos/grupos-search.php",cache:!1,dataType:"json",data:{tipo:"TEMP-SECCIONPACK",tipobusqueda:"4",id:e},success:function(e){var a=0,i=e.length,o="",n="";if(i>0){for(;a<i;)"0"==e[a].td_idgruposeccion?(n="",disabled=" disabled"):(n=" checked",disabled=""),o+='<tr data-idmodel="'+e[a].td_idgruposeccion+'" data-idpackseccion="'+e[a].tp_idseccionpack+'">',
o+='<td><input type="checkbox" class="filled-in" id="chkSeccion'+a+'" name="seccion['+a+'][chkSeccion]"'+n+' value="'+e[a].tp_idseccionpack+'" /><label for="chkSeccion'+a+'"></label></td>',o+='<td><div class="mdl-input-js mdl-textfield mdl-js-textfield no-padding"><input class="mdl-textfield__input seccion no-margin"'+disabled+' type="text" name="seccion['+a+'][txtNombreSeccion]" id="txtNombreSeccion'+a+'" value="'+e[a].tp_nombre+'"><label class="mdl-textfield__label" for="txtNombreSeccion'+a+'"></label></div></td>',o+="</tr>",++a;$(t).html(o),registerScriptMDL("#tableSeccion .mdl-input-js")}else $(t).html("<h5>No se encontraron resultados.</h5>")},error:function(e){console.log(e)}})}function GuardarCategoria(){var e=new FormData;if($("#form1").valid()){var t=$("#modalRegCategoria :input").serializeArray();e.append("btnAplicarCategoria","btnAplicarCategoria"),e.append("hdIdEmpresa",$("#hdIdEmpresa").val()),e.append("hdIdCentro",$("#hdIdCentro").val()),$.each(t,function(t,a){e.append(a.name,a.value)}),$.ajax({type:"POST",url:"services/categorias/categoria-post.php",cache:!1,dataType:"json",data:e,contentType:!1,processData:!1,success:function(e){createSnackbar(e.titulomsje),"0"!=e.rpta&&(closeCustomModal("#modalRegCategoria"),ListarCategorias("1"))},error:function(e){console.log(e)}})}}function EliminarCategoria(){indexList=0,elemsSelected=$("#gvCategoria .selected"),EliminarItemCategoria(elemsSelected[0],"multiple")}function EliminarItemCategoria(e,t){var a=new FormData,i=e.getAttribute("data-idmodel");a.append("btnEliminar","btnEliminar"),a.append("hdIdCategoria",i),$.ajax({url:"services/categorias/categoria-post.php",type:"POST",dataType:"json",data:a,cache:!1,contentType:!1,processData:!1,success:function(a){var i="",o=$(e),n=!1;"0"==a.rpta?(n=!0,i="No se puede eliminar"):(o.fadeOut(400,function(){$(this).remove()}),"multiple"==t?(++indexList,indexList<=elemsSelected.length-1?EliminarItemCategoria(elemsSelected[indexList],t):(n=!0,i=a.titulomsje)):"single"==t&&(n=!0,i=a.titulomsje)),n&&(createSnackbar(i),$(".actionbar").hasClass("is-visible")&&$(".back-button").trigger("click"),"undefined"!=typeof endCallback&&endCallback())},error:function(e){console.log(e)}})}function EliminarPack(){indexList=0,elemsSelected=$("#gvPacks .selected"),EliminarItemPack(elemsSelected[0],"multiple")}function EliminarItemPack(e,t,a){var i=new FormData,o=e.getAttribute("data-idmodel");i.append("btnEliminar","btnEliminar"),i.append("hdIdPack",o),$.ajax({url:"services/grupos/grupos-post.php",type:"POST",dataType:"json",data:i,cache:!1,contentType:!1,processData:!1,success:function(i){var o="",n=!1;"0"==i.rpta?(n=!0,o="No se puede eliminar"):($(e).fadeOut(400,function(){$(this).remove()}),"multiple"==t?(++indexList,indexList<=elemsSelected.length-1?EliminarItemPack(elemsSelected[indexList],t):(n=!0,o=i.titulomsje)):"single"==t&&(n=!0,o=i.titulomsje)),n&&(createSnackbar(o),$(".actionbar").hasClass("is-visible")&&$(".back-button").trigger("click"),"undefined"!=typeof a&&a())},error:function(e){console.log(e)}})}function EliminarArticulo(e,t,a,i){indexList=0,elemsSelected=$(e+" .selected").toArray(),EliminarItemArticulo(elemsSelected[0],"multiple",i)}function EliminarItemArticulo(e,t,a){var i=new FormData,o=e.getAttribute("data-idmodel");i.append("btnEliminar","btnEliminar"),i.append("hdIdArticulo",o),$.ajax({url:"services/productos/productos-post.php",type:"POST",dataType:"json",data:i,cache:!1,contentType:!1,processData:!1,success:function(i){var o="",n=!1;"0"==i.rpta?(n=!0,o="No se puede eliminar"):($(e).fadeOut(400,function(){$(this).remove()}),"multiple"==t?(++indexList,indexList<=elemsSelected.length-1?EliminarItemArticulo(elemsSelected[indexList],t):(n=!0,o=i.titulomsje)):"single"==t&&(n=!0,o=i.titulomsje)),n&&(createSnackbar(o),$(".actionbar").hasClass("is-visible")&&$(".back-button").trigger("click"),"undefined"!=typeof a&&a())},error:function(e){console.log(e)}})}function setDateFromCalendar(e){var t=e.getCurrentDate(),a=e.getCurrentDate("-");lblFechaCompleta.text(e.getCurrentDate("large")),lblFechaCorta.text(t),$("#hdFecha").val(a)}function showMenuWhenView(){var e="1",t="0";if(pnlViewAllArticles.find('.view-button[data-action="view-menu"]').hasClass("active")){e="2";var a=document.querySelector("#pnlSubMenu a.active");"undefined"!=typeof a&&(t=a.getAttribute("data-idmodel"))}ListarArticulos_Menu(e,t,"1")}function settingCalendar(){var e=new Calendar("#pnlCalendarioIndividual",{onInit:function(e){var t=e.year,a=e.month+1;e.day;ListarDiasAsignados(t,a)},onDayClick:function(e){var t=e.getAttribute("data-estadomenudia");$("#hdEstadoApertura").val(t),setDateFromCalendar(calendario),showMenuWhenView(),"01"==t?$("#btnActionMenu").addClass("hide"):$("#btnActionMenu").removeClass("hide"),pnlShowCalendar.removeClass("is-visible")},onMonthChange:function(e){var t=e.year,a=e.month+1;ListarDiasAsignados(t,a)}});return e}function ListarDiasAsignados(e,t){$.ajax({url:"services/cartadia/cartadia-dias.php",type:"GET",dataType:"json",data:{tipobusqueda:"1",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),anho:e,mes:t},success:function(e){var t=e.length,a=0,i="#pnlCalendarioIndividual";if(t>0)for(;a<t;){var o=$(i+' .day[data-day="'+e[a].dia+'"][data-month="'+e[a].mes+'"][data-year="'+e[a].anho+'"]');o.attr("data-estadomenudia",e[a].estado),"01"==e[a].estado&&o.addClass("open"),++a}$(i+" .selected:first").find("button").trigger("click")},error:function(e){console.log(e)}})}function buildCarta_lista(e,t){var a="#optSubMenu",i=0,o=e.length,n="",r=!1;if(o>0){for(;i<o;)r=1==e[i].Actual,n+='<li><a class="grey-text text-darken-4" data-idmodel="'+e[i].tm_idcarta+'" data-actual="'+r+'"data-type="carta" href="#"><i class="material-icons icon v-align-middle">',n+=r?"&#xE838;":"&#xE83A;",n+='</i><span class="text v-align-middle">'+e[i].tm_nombre+"</span></a></li>",++i;$("#btnActionMenu").removeClass("hide"),paginaCarta_lista+=1,$("#hdPageCarta_lista").value=paginaCarta_lista,"1"==t?$(a).html(n):$(a).append(n),setCartaSelected(a)}else"1"==t&&$(a).html("")}function buildCarta_grilla(e,t){var a="#gvCarta",i=a+" .gridview-content",o=0,n=e.length,r="",l=!1;if(n>0){for(;o<n;)l=1==e[o].Actual,r+='<li data-idmodel="'+e[o].tm_idcarta+'" class="collection-item dato pos-rel expandable no-border" data-baselement="'+a+'"data-actual="'+l+'">',r+='<input type="checkbox" name="chkItemCarta[]" value="'+e[o].tm_idcarta+'" />',r+='<h4 class="left">'+e[o].tm_nombre+"</h4>",r+='<i class="icon-select height-centered material-icons white-text circle place-top-right">done</i><div class="layer-select"></div>',r+='<div class="grouped-buttons place-bottom-right padding5">',r+='<a class="padding5 mdl-button mdl-button--icon tooltipped" href="#" data-action="more" data-delay="50" data-position="bottom" data-tooltip="M&aacute;s"><i class="material-icons">&#xE5D4;</i></a>',r+='<ul class="dropdown">',r+='<li><a href="#" data-action="view-content">Ver contenido</a></li>',r+='<li><a href="#" data-action="activate">Activar carta</a></li>',r+='<li><a href="#" data-action="edit">Editar</a></li>',r+='<li><a href="#" data-action="delete">Eliminar</a></li>',r+='<li><a href="#" data-action="stats">Ir a estad&iacute;sticas</a></li>',r+="</ul>",r+="</div>",r+="</li>",++o;paginaCarta_lista+=1,$("#hdPageCarta_grilla").value=paginaCarta_lista,"1"==t?$(i).html(r):$(i).append(r),setCartaSelected(i)}else"1"==t&&$(i).html("")}function ListarCartas(e,t){$.ajax({type:"GET",url:"services/cartadia/cartas-search.php",cache:!1,dataType:"json",data:{idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),criterio:"",pagina:t},success:function(a){"lista"==e?buildCarta_lista(a,t):buildCarta_grilla(a,t)},error:function(e){console.log(e)}})}function setCartaSelected(e){var t=$(e).find('a[data-actual="true"]');t.length>0?t.trigger("click"):$(e).find("a").first().trigger("click")}function buildMenu(e,t){var a="",i=0,o=e.length,n="#gvArticuloMenu tbody",r=$("#pnlViewAllArticles .view-button.active").attr("data-action");if(o>0){for(;i<o;){var l="undefined"==typeof e[i].ta_estadomenudia?"00":e[i].ta_estadomenudia;a+='<tr data-iddetalle="'+e[i].iddetalle+'" data-estadomenudia="'+l+'">',a+="<td>","00"==l&&"view-list"==r&&(a+='<input type="checkbox" class="filled-in" id="chkDetalle'+i+'" name="mc_articulo['+i+'][chkDetalle]" value="'+e[i].iddetalle+'" /><label for="chkDetalle'+i+'"></label>'),a+="</td>",a+='<td data-title="Articulo" class="v-align-middle pos-rel"><input name="mc_articulo['+i+'][iddetalle]" type="hidden" id="iddetalle'+i+'" value="'+e[i].iddetalle+'" /><input name="mc_articulo['+i+'][idproducto]" type="hidden" id="idproducto'+i+'" value="'+e[i].tm_idproducto+'" />'+e[i].nombreProducto,"01"==l&&(a+='<div class="place-top-right margin10 padding5 rounded blue white-text">APERTURADO</div>'),a+="</td>",a+='<td data-title="Stock">',a+='<div class="mdl-input-js mdl-textfield mdl-js-textfield full-size no-padding"><input disabled class="mdl-textfield__input align-right no-margin stock" type="number" step="any" name="mc_articulo['+i+'][stock]" id="stock'+i+'" value="'+e[i].td_stockdia+'"><label class="mdl-textfield__label" for="stock'+i+'"></label></div>',a+="</td>",a+='<td data-title="Precio">',a+='<div class="mdl-input-js mdl-textfield mdl-js-textfield full-size no-padding"><input disabled class="mdl-textfield__input align-right no-margin precio" type="number" step="any" name="mc_articulo['+i+'][precio]" id="precio'+i+'" value="'+Number(e[i].td_precio).toFixed(2)+'"><label class="mdl-textfield__label" for="precio'+i+'"></label></div>',a+="</td>",a+="</tr>",++i}paginaDetalle+=1,$("#hdPageDetalle").val(paginaDetalle),"1"==t?($(n).html(a),$("#pnlViewAllArticles").removeClass("hide")):$(n).append(a),registerScriptMDL(n+" .mdl-input-js")}else"1"==t&&$(n).html("")}function ListarArticulos_Menu(e,t,a){var i="",o=$("#hdFecha").val();precargaExp("#pnlMenuCarta",!0),e="0"==t?"1":e,$.ajax({type:"GET",url:"services/cartadia/cartadia-search.php",cache:!1,dataType:"json",data:{tipobusqueda:e,idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),tipomenu:"03",fecha:o,idgrupo:t,criterio:i,pagina:a},success:function(e){buildMenu(e,a),precargaExp("#pnlMenuCarta",!1)},error:function(e){console.log(e)}})}function ListarArticulos_Carta(e){var t=$("#txtSearch").val(),a=$("#pnlSubMenu a.active").attr("data-idmodel");precargaExp("#pnlMenuCarta",!0),$.ajax({type:"GET",url:"services/cartadia/cartadia-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"1",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),tipomenu:"00",idcarta:a,criterio:t,pagina:e},success:function(t){buildMenu(t,e),precargaExp("#pnlMenuCarta",!1)},error:function(e){console.log(e)}})}function AperturarMenu(){MessageBox({content:"¿Realmente desea aperturar en esta fecha?",width:"320px",height:"130px",buttons:[{primary:!0,content:"Aperturar",onClickButton:function(e){var t=new FormData;t.append("btnAperturarMenu","btnAperturarMenu"),t.append("hdIdEmpresa",$("#hdIdEmpresa").val()),t.append("hdIdCentro",$("#hdIdCentro").val()),t.append("hdTipoCarta","03"),t.append("hdFecha",$("#hdFecha").val()),$.ajax({type:"POST",url:"services/cartadia/cartadia-post.php",cache:!1,contentType:!1,processData:!1,dataType:"json",data:t,success:function(e){createSnackbar(e.titulomsje),getDataMenu("1")},error:function(e){console.log(e)}})}}],cancelButton:!0})}function CalcularPorciones(){var e=$("#tableReceta tbody tr"),t=0,a=e.length,i=Number($("#txtNroPorciones").val()),o=0,n=0;if(a>0)for(;t<a;){var r=Number(e[t].getElementsByClassName("hdCostoInsumo")[0].value),l=Number(e[t].getElementsByClassName("cantidad")[0].value),d=e[t].getElementsByClassName("avgxporcion")[0],s=e[t].getElementsByClassName("cell-avgxporcion")[0],c=e[t].getElementsByClassName("costoreceta")[0],u=e[t].getElementsByClassName("hdCostoReceta")[0];if($("#txtNroPorciones").val().trim().length>0){var p=l/i;n=r*p,d.value=p,s.innerHTML=p.toFixed(3),c.innerHTML=n.toFixed(2),u.value=n.toFixed(2)}else d.value="0",s.innerHTML="0.00",c.innerHTML="0.00",u.value="0.00";o+=Number(n),++t}$("#lblTotalCostoReceta").text("S/. "+o.toFixed(2))}function crearItem_Presentacion(e,t,a,i,o){var n="";return n+='<tr data-iddetalle="0" data-idpresentacion="'+e+'" data-idunidadmedida="'+t+'">',n+='<td class="hide">',n+='<input type="hidden" name="pre_insumo['+counter_presentacion+'][idpresentacion]" value="'+e+'" />',n+='<input type="hidden" name="pre_insumo['+counter_presentacion+'][idunidadmedida]" value="'+t+'" />',n+='<input type="hidden" name="pre_insumo['+counter_presentacion+'][medida]" value="'+o+'" />',n+="</td>",n+='<td class="presentacion">'+a+"</td>",n+='<td class="unidadmedida">'+i+"</td>",n+='<td class="medida text-right">'+o+"</td>",n+='<td class="text-center"><a class="padding5 mdl-button mdl-button--icon tooltipped center-block" href="#" data-action="delete" data-delay="50" data-position="bottom" data-tooltip="Eliminar"><i class="material-icons">&#xE872;</i></a></td>',n+="</tr>"}function clearFormPresentacion(){$("#ddlPresentacion")[0].selectedIndex=0,$("#ddlUnidadMedida")[0].selectedIndex=0,$("#txtMedida").val("0")}function AgregarPresentacion(){var e=$("#tablePresentacion tbody tr.selected"),t=$("#ddlPresentacion").val(),a=$("#ddlPresentacion option:selected").text(),i=$("#ddlUnidadMedida").val(),o=$("#ddlUnidadMedida option:selected").attr("data-simbolo"),n=Number($("#txtMedida").val());if($("#btnPresentacionAdd").hasClass("mode-edit"))e.length>0&&(e.attr("data-idpresentacion",t),e.attr("data-idunidadmedida",i),e.find(".presentacion").text(a),e.find(".unidadmedida").text(o),e.find(".medida").text(n),closeCustomModal("#pnlInfoPresentacion"),$("#tablePresentacion tbody tr.selected").removeClass("selected"));else{$("#tablePresentacion tbody tr:first").find("h3").length>0&&$("#tablePresentacion tbody tr").remove();var r=crearItem_Presentacion(t,i,a,o,n);$("#tablePresentacion tbody").append(r),++counter_presentacion,clearFormPresentacion(),$("#ddlPresentacion").focus()}}function ListarPresentaciones(e){$.ajax({type:"GET",url:"services/presentacion/presentacion-search.php",cache:!1,data:"tipobusqueda=1&idinsumo="+e+"&tipoinsumo=01",dataType:"json",success:function(e){var t=e.length,a=0,i="";if(t>0)for(;a<t;)i+=crearItem_Presentacion(e[a].tm_idpresentacion,e[a].tm_idunidadmedida,e[a].Presentacion,e[a].UnidadMedida,e[a].td_medida),++a,counter_presentacion=a;$("#tablePresentacion tbody").html(i)},error:function(e){console.log(e)}})}function GetInfoPresentacion(){var e=$("#tablePresentacion tbody tr.selected:first"),t=e[0].getAttribute("data-idpresentacion"),a=e[0].getAttribute("data-idunidadmedida"),i=e.find(".medida").text();$("#ddlPresentacion").val(t),$("#ddlUnidadMedida").val(a),$("#txtMedida").val(i)}function MostrarSelectUnidadMedida(e){e?($("#pnlReceta").removeClass("hide"),$("#pnlPresentacion, #rowUnidadMedida").addClass("hide")):($("#pnlReceta").addClass("hide"),$("#pnlPresentacion, #rowUnidadMedida").removeClass("hide"))}function Buscar(){$("#gvCategoria").is(":visible")?ListarCategorias("1"):$("#gvAlmacen").is(":visible")?ListarAlmacen("1"):ListarArticulos("1")}function showAll(){$("#txtSearch").val(""),Buscar()}$(function(){calendario=settingCalendar(),setDateFromCalendar(calendario),$("#btnSearch").on("click",function(e){e.preventDefault();var t;t=$("#gvCategoria").is(":visible")?gvCategoria:$("#gvAlmacen").is(":visible")?gvAlmacen:gvArticulo,t.showAppBar(!0,"search"),$("#txtSearch").focus()}),$("#txtNroPorciones").on("keyup",function(e){e.preventDefault(),CalcularPorciones()}),$("#tableReceta").on("click","a",function(e){e.preventDefault();var t=this.getAttribute("data-action");if("delete"==t){var a=getParentsUntil(this,"#tableReceta","tr");$(a).fadeOut(400,function(){$(this).remove()})}}),$("#tableReceta tbody").on("keyup","input:text",function(e){e.preventDefault(),CalcularPorciones()}),$("#gvArticulo .scrollbarra").on("scroll",function(e){gvArticulo.listenerScroll(this,e)}),$("#gvArticulo .table tbody").on("scroll",function(e){gvArticulo.listenerScroll(this,e)}),$("#btnCloseFilter").on("click",function(e){e.preventDefault(),toggleOptions_v2("#pnlPackAsignacion","right")}),$("#btnAsignarGrupoProducto").on("click",function(e){e.preventDefault(),AsignacionGrupoArticulo()}),$("#btnProgram").on("click",function(e){e.preventDefault(),AsignarArticulosMenu()}),$("#tableSeccion tbody").on("click","input:checkbox",function(e){handlerRowCheck(this,"#tableSeccion",e)}),$("#tableSeccion tbody").on("click","tr",function(e){handlerRowCheck(this,"#tableSeccion",e)}),$("#tableSeccion tbody").on("click","tr input:text",function(e){e.stopPropagation()}),$("#gvArticulo tbody").on("click","input:checkbox",function(e){handlerRowCheck(this,"#gvArticulo",e)}),$("#gvArticulo tbody").on("click","tr",function(e){handlerRowCheck(this,"#gvArticulo",e)}),$("#gvArticulo tbody").on("click","tr .mdl-textfield__input",function(e){e.stopPropagation()}),$("#gvArticuloMenu tbody").on("click","input:checkbox",function(e){handlerRowCheck(this,"#gvArticuloMenu",e)}),$("#gvArticuloMenu tbody").on("click","tr",function(e){handlerRowCheck(this,"#gvArticuloMenu",e)}),$("#gvArticuloMenu tbody").on("click","tr .mdl-textfield__input",function(e){e.stopPropagation()}),$("#btnSelectAll").on("click",function(e){e.preventDefault(),$("#gvCategoria").is(":visible")?gvCategoria.selectAll():$("#gvPacks").is(":visible")?gvPacks.selectAll():"true"==$("#hdAsignacionMenu").val()?(checkAllTable("#gvArticulo tbody tr",!0),gvArticulo.showAppBar(!0,"edit")):gvArticulo.selectAll()}),$("#btnUnSelectAll").on("click",function(e){e.preventDefault(),panelListado.is(":visible")?$("#gvCategoria").is(":visible")?gvCategoria.removeSelection():$("#gvPacks").is(":visible")?gvPacks.removeSelection():removeSelectionInMenu():removeSelectionInMenu()}),$("#gvCategoria").on("click touchend",".dropdown a",function(e){e.preventDefault();var t=this.getAttribute("data-action"),a=getParentsUntil(this,"#gvCategoria",".dato"),i=a[0].getAttribute("data-idmodel");"edit"==t?GoToEditCategoria(i):"delete"==t&&MessageBox({content:"¿Desea eliminar este elemento?",width:"320px",height:"130px",buttons:[{primary:!0,content:"Eliminar",onClickButton:function(e){EliminarItemCategoria(a[0],"single")}}],cancelButton:!0})}),$("#btnAplicarCategoria").on("click",function(e){e.preventDefault(),GuardarCategoria()}),$("#gvPacks").on("click touchend",".dropdown a",function(e){e.preventDefault();var t=this.getAttribute("data-action"),a=getParentsUntil(this,"#gvPacks",".dato"),i=a[0].getAttribute("data-idmodel");"edit"==t?GoToEditPack(i):"delete"==t&&MessageBox({content:"¿Desea eliminar este elemento?",width:"320px",height:"130px",buttons:[{primary:!0,content:"Eliminar",onClickButton:function(e){EliminarItemPack(a[0],"single")}}],cancelButton:!0})}),btnShowCalendar.on("click touchend",function(e){e.preventDefault(),e.stopPropagation(),pnlShowCalendar.toggleClass("is-visible")}),pnlSubMenu.on("click","a",function(e){e.preventDefault(),pnlSubMenu.find(".active").removeClass("active"),$(this).addClass("active"),$("#titleMenuCarta").html(this.innerHTML),paginaDetalle=1,"carta"==this.getAttribute("data-type")?ListarArticulos_Carta("1"):ListarArticulos_Menu("2",this.getAttribute("data-idmodel"),"1"),showOrHideCharmOptions("#pnlSubMenu",!1)});var e=pnlInsumo.getInput();selectable(e,{url:"services/insumos/insumos-autocomplete.php",container:"hrowSearchInsumo",data:{tipobusqueda:"5",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val()},successCallback:ListarInsumos}),$("#gvArticulo").on("click touchend",".dropdown a",function(e){e.preventDefault();var t=this.getAttribute("data-action"),a=getParentsUntil(this,"#gvArticulo",".dato"),i=$(a).find(".dropdown"),o=$(a).attr("data-idmodel");gvArticulo.removeSelection(),"edit"==t?GoToEditArticulo(o):"delete"==t&&MessageBox({content:"¿Desea eliminar este elemento?",width:"320px",height:"130px",buttons:[{primary:!0,content:"Eliminar",onClickButton:function(e){EliminarItemArticulo(a[0],"single")}}],cancelButton:!0}),i.removeClass("fixed")}),$("#btnActionMenu").on("click touchend",".mfb-component__button--child",function(e){e.preventDefault();var t=this.getAttribute("data-action");"search-articles"==t?($("#gvArticulo tbody").html(""),$("#gvArticulo > .gridview-content > .mdl-grid").html(""),$("#hdAsignacionMenu").val("true"),$("#hdModeMenuEdit").val("NEW"),$("#btnProgram").removeClass("hide"),$("#btnGoToPacks").removeClass("show-in-select").addClass("hide"),$("#pnlMenuCarta").addClass("hide"),panelListado.removeClass("hide"),habilitarLink("#btnMoreSites",!1),ListarArticulos("1")):"open-menu"==t&&AperturarMenu(),$(".buttonfab-overlay").trigger("click")}),btnShowSubOpciones.on("click",function(e){e.preventDefault(),showOrHideCharmOptions("#pnlSubMenu",!0)}),btnChooseReceta.on("click",function(e){e.preventDefault(),e.stopPropagation(),mnuTipoReceta.addClass("is-visible")}),mnuTipoReceta.on("click","a",function(e){var t=this.getAttribute("data-tiporeceta");return"0"==$("#hdIdArticulo").val()&&$("#tableReceta tbody tr").length>0?(MessageBox({content:"Si ha agregado insumos a este tipo de receta, guarde el artículo para no pderder sus cambios.",width:"320px",height:"130px",cancelButton:!0}),!1):("03"==t?($("#pnlTimePrepMenu").removeClass("hide"),$("#pnlTimePrepCarta").addClass("hide")):($("#pnlTimePrepMenu").addClass("hide"),$("#pnlTimePrepCarta").removeClass("hide")),btnChooseReceta.find(".text").text(this.innerHTML).attr("data-tiporeceta",t),mnuTipoReceta.removeClass("is-visible"),void ListarReceta($("#hdIdArticulo").val(),t))}),btnAplicarGrupo.on("click",function(e){e.preventDefault(),GuardarGrupo()}),btnNuevo.on("click",function(e){e.preventDefault(),Nuevo()}),btnBackToArticles.on("click",function(e){e.preventDefault(),pnlRegArticulo.addClass("hide"),panelListado.removeClass("hide"),btnNuevo.removeClass("hide")}),btnSearchInsumo.on("click",function(e){e.preventDefault(),hrowMain.addClass("hide"),hrowSearchInsumo.removeClass("hide"),btnHideSearchInsumo.removeClass("hide");var t=hrowSearchInsumo.parent();t.removeClass("blue"),t.addClass("white");var a=hrowSearchInsumo.find(".taggle_input");a.focus()}),btnHideSearchInsumo.on("click",function(e){e.preventDefault(),$(this).addClass("hide"),hrowMain.removeClass("hide"),hrowSearchInsumo.addClass("hide");var t=hrowSearchInsumo.parent();t.removeClass("white"),t.addClass("blue")}),btnAddInsumo.on("click",function(e){e.preventDefault(),addInsumoToReceta()}),btnAplicarArticulo.on("click",function(e){e.preventDefault(),GuardarArticulo()}),chkTieneReceta.on("click",function(e){var t=this.checked;helperReceta.text(t?"SI":"NO"),MostrarSelectUnidadMedida(t)}),chkEsAgregado.on("click",function(e){helperAgregado.text(this.checked?"SI":"NO")}),$("#articulos-actionbar").on("click","button",function(e){e.preventDefault();var t=this.getAttribute("data-action");"add-list"==t?($("#gvPacksAsignacion").addClass("custom"),toggleOptions_v2("#pnlPackAsignacion","right"),ListarPacks("#gvPacksAsignacion","1")):"delete"==t&&MessageBox({content:"¿Desea eliminar todo lo seleccionado?",width:"320px",height:"130px",buttons:[{primary:!0,content:"Eliminar",onClickButton:function(e){$("#pnlListado").is(":visible")?$("#gvCategoria").is(":visible")?EliminarCategoria():$("#gvPacks").is(":visible")?EliminarPack():EliminarArticulo():EliminarAsignados()}}],cancelButton:!0})});var t=hrowSearchInsumo.find(".gridview");t.on("click",".icon-expand",function(e){return e.preventDefault(),alert("test"),!1}),t.on("click","li",function(e){var a=this.getElementsByClassName("badges_subitem")[0];insumoTag_setValues(t,this,a),e.preventDefault()}),t.on("click",".badges_subitem",function(e){e.preventDefault(),e.stopPropagation();var a=this.parentNode.parentNode;return insumoTag_setValues(t,a,this),!1}),pnlViewAllArticles.on("click",".view-button",function(e){e.preventDefault();var t="#titleMenuCarta, #btnShowSubOpciones";$(this).parent().find(".active").removeClass("active"),$(this).addClass("active"),$("#optIndividual").removeClass("hide"),"view-menu"==this.getAttribute("data-action")?($(t).removeClass("hide"),$("#btnActionMenu").addClass("hide"),paginaPack_lista=1,ListarPacks_viewlist("1")):($(t).addClass("hide"),$("#btnActionMenu").removeClass("hide"),paginaDetalle=1,ListarArticulos_Menu("1",0,"1"))}),$("#btnRecursosBack").on("click",listenerDefaultBackButton),$("#btnCerrarModalGrupo").on("click",function(e){e.preventDefault(),closeCustomModal("#modalRegPack")}),$("#chkAllSeccion").on("click",function(e){checkAllTable("#tableSeccion tbody tr",this.checked)}),$("#btnNuevaCarta").on("click",function(e){e.preventDefault(),openCustomModal("#modalRegCarta")}),$("#btnAplicarCarta").on("click",function(e){e.preventDefault(),RegistrarCarta()}),$("#btnCerrarModalCarta").on("click",function(e){e.preventDefault(),closeCustomModal("#modalRegCarta")}),$("#btnAgregarPresentacion").on("click",function(e){e.preventDefault(),openModalCallBack("#pnlInfoPresentacion",function(){ListarUnidadMedida_Combo("#ddlUnidadMedida","0"),ListarPresentacion_Combo("0")})}),$("#btnPresentacionAdd").on("click",function(e){e.preventDefault(),AgregarPresentacion()}),$("#tablePresentacion tbody").on("click","a",function(e){e.preventDefault();var t=this.getAttribute("data-action");if("delete"==t){var a=getParentsUntil(this,"#tablePresentacion","tr");$(a).fadeOut(400,function(){$(this).remove()})}})});var listenerDefaultBackButton=function(e){$("#btnUnSelectAll").trigger("click")},listenerAsignaPackInBack=function(e){e.preventDefault();var t="#gvPacksAsignacion";"undefined"!=typeof $(t+" .dato.selected")&&$(t+" .dato.selected").removeClass("selected"),[].forEach.call($(t+' input[type="checkbox"]'),function(e){e.checked=!1}),$("#btnRecursosBack").off("click",listenerAsignaPackInBack),$("#btnRecursosBack").on("click",listenerDefaultBackButton)},handlerRowCheck=function(e,t,a){if("textbox"!==(a.target||{}).type){var i,o,n,r=e,l=!0;if("checkbox"!==(e||{}).type?(a.preventDefault(),i=e,r=e.querySelector('input[type="checkbox"]'),null!=r&&(r.checked=!r.checked)):i=getParentsUntil(r,t,"tr"),"#gvArticulo"==t||"#gvArticuloMenu"==t){if("#gvArticuloMenu"==t){if("01"==i.getAttribute("data-estadomenudia"))return!1;var d=$("#pnlViewAllArticles .view-button.active").attr("data-action");if("view-list"!=d)return!1}var s=i.getElementsByClassName("stock")[0],c=i.getElementsByClassName("precio")[0];o="#gvArticulo"==t?gvArticulo:gvArticuloMenu,n="03"==$("#hdTipoCarta").val()?[s,c]:c,null!=r&&(habilitarControl(n,r.checked),r.checked?(i.classList.add("selected"),l=!0,c.parentNode.classList.remove("is-disabled"),"03"==$("#hdTipoCarta").val()?(s.parentNode.classList.remove("is-disabled"),s.focus(),s.select()):(c.focus(),c.select())):(i.classList.remove("selected"),s.parentNode.classList.add("is-disabled"),c.parentNode.classList.add("is-disabled"),0==$(t).find(".selected").length&&(l=!1))),o.showAppBar(l,"edit")}else if("#tableSeccion"==t){var u=i.getElementsByClassName("seccion")[0];habilitarControl(u,r.checked),r.checked?(i.classList.add("selected"),u.parentNode.classList.remove("is-disabled"),u.focus(),u.select()):(i.classList.remove("selected"),u.parentNode.classList.add("is-disabled"))}else if("#gvCategoria"==t){var p=i.getElementsByClassName("mdl-textfield")[0],m=i.getElementsByClassName("title")[0];if(null!=r){var g=r.checked;if(g){i.classList.add("selected"),m.classList.add("hide"),p.classList.remove("hide");var h=p.getElementsByClassName("categoria")[0];h.focus(),$("#btnCategoriaEdit").removeClass("hide")}else i.classList.remove("selected"),m.classList.remove("hide"),p.classList.add("hide"),g=0!=$("#gvCategoria .selected").length;gvCategoria.showAppBar(g,"edit"),g===!1&&$("#btnCategoriaEdit").addClass("hide")}}}},calendario,paginaPack_lista=1,paginaCarta_lista=1,paginaCarta_grilla=1,paginaDetalle=1,indexList=0,elemsSelected,progress=0,progressError=!1,completado=!0,intervalProgress=new Interval(function(){var e=elemsSelected[indexList].querySelector(".progress .determinate");++progress,1==progress&&e.addClass("teal lighten-1"),e.style.width=progress+"%",100==progress&&intervalProgress.stop()},100),_idinsumo=0,UnidadMedida={id:0,simbolo:"",idpresentacion:0},messagesValid={txtNombreCategoria:{remote:"Este nombre de categoría ya existe"}},gvArticuloMenu=new DataList("#gvArticuloMenu",{actionbar:"#articulos-actionbar",onSearch:function(){getDataMenu("1")}}),gvCategoria=new DataList("#gvCategoria",{typeview:"checklist",actionbar:"#articulos-actionbar",onSearch:function(){ListarCategorias(gvCategoria.currentPage())}}),gvPacks=new DataList("#gvPacks",{actionbar:"#articulos-actionbar",onSearch:function(){ListarPacks("#gvPacks",gvPacks.currentPage())}}),gvPacksAsignacion=new DataList("#gvPacksAsignacion",{actionbar:"#articulos-actionbar",onSearch:function(){ListarPacks("#gvPacksAsignacion",gvPacksAsignacion.currentPage())},oneItemClick:function(e){var t=gvPacksAsignacion.getContainer();if(t.hasClass("custom")){var a=e.target,i=getParentsUntil(a,"#gvPacksAsignacion",".dato");if("li"===a.nodeName.toLowerCase())$(a).siblings().removeClass("subitem-selected"),$(a).toggleClass("subitem-selected"),$(a).hasClass("subitem-selected")?$(i).addClass("selected"):$(i).removeClass("selected");else if($(i).toggleClass("selected"),$(i).hasClass("select-in-details")){var o=$(i).find("li"),n=o[0];o.removeClass("subitem-selected"),$(i).hasClass("selected")?$(n).addClass("subitem-selected"):$(n).removeClass("subitem-selected")}}}}),gvArticulo=new DataList("#gvArticulo",{actionbar:"#articulos-actionbar",onSearch:function(){ListarArticulos(gvArticulo.currentPage())}}),pnlRegArticulo=$("#pnlRegArticulo"),panelListado=$("#pnlListado"),hdIdPack=$("#hdIdPack"),lblFechaCompleta=$("#lblFechaCompleta"),lblFechaCorta=$("#lblFechaCorta"),btnChooseReceta=$("#btnChooseReceta"),mnuTipoReceta=$("#mnuTipoReceta"),btnAddInsumo=$("#btnAddInsumo"),btnNuevo=$("#btnNuevo"),btnSearchInsumo=$("#btnSearchInsumo"),hrowMain=$("#hrowMain"),hrowSearchInsumo=$("#hrowSearchInsumo"),btnHideSearchInsumo=$("#btnHideSearchInsumo"),btnBackToArticles=$("#btnBackToArticles"),btnShowSubOpciones=$("#btnShowSubOpciones"),btnAplicarArticulo=$("#btnAplicarArticulo"),btnAplicarGrupo=$("#btnAplicarGrupo"),chkTieneReceta=$("#chkTieneReceta"),helperReceta=$("#helperReceta"),chkEsAgregado=$("#chkEsAgregado"),helperAgregado=$("#helperAgregado"),btnShowCalendar=$("#btnShowCalendar"),pnlShowCalendar=$("#pnlShowCalendar"),pnlSubMenu=$("#pnlSubMenu"),pnlViewAllArticles=$("#pnlViewAllArticles"),pnlInsumo=new Taggle("pnlInsumo",{tagFormatter:function(e){var t=e;return t.setAttribute("data-idinsumo",_idinsumo),t.setAttribute("data-idunidadmedida",UnidadMedida.id),t.setAttribute("data-idpresentacion",UnidadMedida.idpresentacion),t}}),fila_Receta=0,counter_presentacion=0;