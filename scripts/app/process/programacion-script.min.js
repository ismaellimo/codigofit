function settingCalendar(){var a="#pnlCalendarioIndividual";$(a).responsiveCalendar({time:getOnlyYearMonth(),onDayClick:function(t){var e="",i="",o=$(this).data("year"),s=$(this).data("month"),n=$(this).data("day"),r=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];e=o+"-"+addLeadingZero(s)+"-"+addLeadingZero(n),fechaTexto=addLeadingZero(n)+" de "+r[s]+" del aÃ±o "+o;var c=$(a+' .day:not(.not-current) a[data-day="'+n+'"][data-month="'+s+'"][data-year="'+o+'"]').parent();i=$(c).attr("data-estado"),$("#hdEstadoApertura").val(i),$("#hdFecha").val(e),$("#gvMenu").attr({"data-fecha":e,"data-estado":i}),paginaGrupo=1,ListarPacks("56","1")},onInit:function(){setTimeout(function(){var t=$("#hdCurrentYear").val(),e=$("#hdCurrentMonth").val();$(a+" .day.today a").trigger("click"),ListarDiasAsignados(t,e,"01")},1e3)},onMonthChange:function(){setTimeout(function(){var t=$(a+" .responsive-calendar .days .day:not(.not-current)").first().children("a"),e=t.attr("data-year"),i=t.attr("data-month");t.trigger("click"),ListarDiasAsignados(e,i,"01")},1e3)}})}function ListarDiasAsignados(a,t,e){var i="";i="03"==e?"DIAS-GRUPAL":"DIAS-INDIVIDUAL",$.ajax({url:"services/cartadia/cartadia-dias.php",type:"GET",dataType:"json",data:{tipobusqueda:i,anho:a,mes:t,tipomenudia:e},success:function(a){var t="",e=a.length,i=0,o="#pnlCalendarioIndividual";if(e>0)for(;e>i;)t="01"==a[i].estado?" open":"",$(o+' .day:not(.not-current) a[data-day="'+a[i].dia+'"][data-month="'+a[i].mes+'"][data-year="'+a[i].anho+'"]').parent().addClass("active"+t).attr("data-estado",a[i].estado),++i}})}function ListarPacks(a,t){var e="",i="",o=$("#txtSearch").val();e="56"==a?"#gvPacksMenu":"#gvPacks",i=e+" .gridview",precargaExp("#pnlMenu",!0),$.ajax({type:"GET",url:"services/grupos/grupos-search.php",cache:!1,dataType:"json",data:{tipobusqueda:a,idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),criterio:o,fechaini:$("#hdFecha").val(),pagina:t},success:function(a){var o,s=0,n=0,r=0,c="",l="",d="0",u=0,p=_.groupBy(a,function(a){return a.tm_idgrupoarticulo+"#"+a.tm_nombre}),m=_.map(p,function(a){return{tm_idgrupoarticulo:a[0].tm_idgrupoarticulo,tm_nombre:a[0].tm_nombre,tm_idmoneda:a[0].tm_idmoneda,tm_simbolo:a[0].tm_simbolo,td_precio:a[0].td_precio,list_secciones:a}});if(r=m.length,r>0){for(;r>s;){if(n=0,d=m[s].tm_idgrupoarticulo,o=m[s].list_secciones,1==o.length?0==o[0].td_nombreseccion.trim().length&&(u=0):u=o.length,l=u>0?"select-in-details":"select-in-item",c+='<div data-idmodel="'+d+'" data-idMoneda="'+m[s].tm_idmoneda+'" class="dato card mdl-cell mdl-cell--2-col mdl-shadow--2dp left '+l+'" data-baselement="'+e+'">',c+='<input type="checkbox" style="display:none;" name="chkItem[]" value="'+d+'">',c+='<i class="icon-select place-top-right margin10 material-icons circle white-text">done</i><div class="layer-select"></div>',c+='<div class="card-content">',c+='<span class="card-title descripcion">'+m[s].tm_nombre+"</span>",u>0){for(c+="<ul>";u>n;)c+="<li>"+o[n].td_nombreseccion+"</li>",++n;c+="</ul>"}c+="</div>",c+='<div class="card-action">',c+='<h4 class="black-text no-margin"><span class="moneda">'+m[s].tm_simbolo+' </span><span class="precio">'+Number(m[s].td_precio).toFixed(2)+"</span></h4>",c+="</div>",c+='<div class="grouped-buttons place-bottom-right padding5 margin5">',c+='<a class="padding5 mdl-button mdl-button--icon tooltipped" href="#" data-action="more" data-delay="50" data-position="bottom" data-tooltip="M&aacute;s"><i class="material-icons">&#xE5D4;</i></a>',c+='<ul class="dropdown">',c+='<li><a href="#" data-action="edit" class="waves-effect">Editar</a></li>',c+='<li><a href="#" data-action="delete" class="waves-effect">Eliminar</a></li>',c+='<li><a href="#" data-action="stats" class="waves-effect">Ir a estad&iacute;sticas</a></li>',c+="</ul>",c+="</div>",c+="</div>",++s}paginaGrupo+=1,$("#hdPageGrupo").val(paginaGrupo),"1"==t?$(i).html(c):$(i).append(c),$("#emptyInProgram").addClass("hide"),$(i+" .grouped-buttons a.tooltipped").tooltip(),initMasonry(i,".mdl-cell--2-col",".dato")}else"1"==t&&$("#emptyInProgram").removeClass("hide");precargaExp("#pnlMenu",!1)},error:function(a){console.log(a)}})}function customEventsBar_Packs(){$("#gvPacks").on("click",".dato.select-in-item",function(a){a.preventDefault(),$(this).toggleClass("selected")}),$("#gvPacks").on("click",".dato.select-in-details li",function(a){a.preventDefault();var t=$(this).parent().parent().parent();$(this).siblings().removeClass("subitem-selected"),$(this).toggleClass("subitem-selected"),$(this).hasClass("subitem-selected")?t.addClass("selected"):t.removeClass("selected")})}function ListarArticulos(a){var t="#gvDatos",e=t+" .gridview",i=$("#txtSearch").val();precargaExp("#pnlAsignacion",!0),$.ajax({url:"services/productos/productos-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"00",idempresa:$("#hdIdEmpresa").val(),idcentro:$("#hdIdCentro").val(),idcategoria:0,criterio:i,pagina:a},success:function(t){var i=0,o=0,s="",n="";if(o=t.length,o>0){for(;o>i;)n="no-set"==t[i].tm_foto?imageDefault:t[i].tm_foto,s+='<div class="mdl-card dato articulo mdl-shadow--2dp mdl-cell mdl-cell--2-col mdl-cell--4-col-tablet mdl-cell--12-col-phone" data-idmodel="'+t[i].tm_idproducto+'">',s+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+t[i].tm_idproducto+'" />',s+='<div class="mdl-card__media pos-rel">',s+='<i class="icon-select centered material-icons white-text circle">done</i>',s+='<img src="'+n+'" width="100%" height="160px" border="0" alt="">',s+="</div>",s+='<div class="layer-select"></div>',s+='<div class="mdl-card__title full-size"><h5 class="fg-dark no-margin">'+t[i].tm_nombre+"</h5></div>",s+="</div>",++i;paginaArticulo+=1,$("#hdPageArticulo").val(paginaArticulo),"1"==a?$(e).html(s):$(e).append(s),$(e+" .grouped-buttons a.tooltipped").tooltip()}else"1"==a&&$(e).html("<h2>No se encontraron resultados.</h2>");precargaExp("#pnlAsignacion",!1)},error:function(a){console.log(a)}})}$(function(){settingCalendar(),gridEvents("#gvPacks",".dato"),gridEvents("#gvDatos",".dato"),listdataEvents_default(),$("#pnlAsignacion .mdl-layout__content").on("scroll",function(){var a=0;isScroll=!0,clearTimeout(timeoutScroll),timeoutScroll=setTimeout(function(){isScroll=!1},delayScroll),$(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight&&($("#tabPack").is(":visible")?(a=Number($("#hdPageGrupo").val()),ListarPacks("55",a)):(a=Number($("#hdPageArticulo").val()),ListarArticulos(a)))}),$("#btnActionMenu").on("click","li a",function(a){a.preventDefault();var t=this.getAttribute("data-action");"search-articles"==t&&$("#pnlMenu").fadeOut(400,function(){$("#pnlAsignacion").fadeIn(400,function(){$("#btnGoToPacks").addClass("show-in-select").removeClass("oculto"),$("#btnAsignarProductos, #btnSearchPacks").addClass("oculto"),0==$("#gvDatos .dato").length&&(paginaArticulo=1,ListarArticulos("1"))})})}),$("#articulos-actionbar").on("click","button",function(a){a.preventDefault();var t=this.getAttribute("data-action");"add-list"==t&&($("#articulos-actionbar .show-in-select").addClass("oculto"),$("#btnAsignarProductos, #btnSearchPacks").removeClass("oculto"),$("#gvPacks").addClass("custom"),gridEvents("#gvPacks",".dato"),customEventsBar_Packs(),$("#tabArticulo").fadeOut(400,function(){$("#tabPack").fadeIn(400,function(){paginaGrupo=1,ListarPacks("55","1")})}))}),$("#btnAsignarProductos").on("click",function(a){a.preventDefault(),AsignarMenu()})});var paginaCarta=1,paginaGrupo=1,paginaArticulo=1,fechaTexto="";