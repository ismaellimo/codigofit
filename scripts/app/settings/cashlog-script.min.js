function LimpiarForm(){$("#hdIdPrimary").val("0"),$("#txtDescripcion").val(""),$("#txtNombre").val("").focus()}function MostrarDatos(){$.ajax({url:"services/ventas/tipomovcaja-search.php",type:"GET",dataType:"json",data:{tipo:"L",tipobusqueda:"1",criterio:""},success:function(t){var a=0,e=t.length,o="";if(e>0)for(;a<e;)o+='<li class="mdl-list__item dato pos-rel" data-id="'+t[a].tm_idtipomovimiento_caja+'">',o+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+t[a].tm_idtipomovimiento_caja+'" />',o+='<span class="mdl-list__item-primary-content">'+t[a].tm_nombre+"</span>",o+='<div class="grouped-buttons place-bottom-right padding5 margin5"><a class="padding5 mdl-button mdl-button--icon tooltipped" href="#" data-action="edit" data-delay="50" data-position="bottom" data-tooltip="Editar"><i class="material-icons">&#xE254;</i></a><a class="padding5 mdl-button mdl-button--icon tooltipped" href="#" data-action="delete" data-delay="50" data-position="bottom" data-tooltip="Eliminar"><i class="material-icons">&#xE872;</i></a></div>',o+="</li>",++a;else o="<h2>No se encontraron registros</h2>";$("#gvDatos .gridview").html(o)},error:function(t){console.log(t)}})}function GuardarDatos(){var t=new FormData,a=$("#modalRegistro :input").serializeArray();t.append("btnGuardar","btnGuardar"),Array.prototype.forEach.call(a,function(a){t.append(a.name,a.value)}),$.ajax({type:"POST",url:"services/ventas/tipomovcaja-post.php",cache:!1,contentType:!1,processData:!1,data:t,dataType:"json",success:function(t){createSnackbar(t.titulomsje),"0"!=t.rpta&&(closeCustomModal("#modalRegistro"),MostrarDatos())},error:function(t){console.log(t)}})}function GetDataById(t){LimpiarForm(),openModalCallBack("#modalRegistro",function(){"0"!=t&&$.ajax({url:"services/ventas/tipomovcaja-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"2",id:t},success:function(t){t.length>0&&($("#hdIdPrimary").val(t[0].tm_idtipomovimiento_caja),$("#txtNombre").val(t[0].tm_nombre),$("#txtDescripcion").val(t[0].tm_descripcion),Materialize.updateTextFields())},error:function(t){console.log(t)}})})}function EliminarItem(t,a){var e=new FormData,o=t.getAttribute("data-id");e.append("btnEliminar","btnEliminar"),e.append("hdIdPrimary",o),$.ajax({type:"POST",url:"services/ventas/tipomovcaja-post.php",cache:!1,contentType:!1,processData:!1,dataType:"json",data:e,success:function(e){var o="",i=!1;"0"==e.rpta?(i=!0,o="No se puede eliminar"):($(t).fadeOut(400,function(){$(this).remove(),0==$("#gvDatos .dato").length&&$("#gvDatos .gridview").html("<h2>No se encontraron registros</h2>")}),"multiple"==a?(++indexList,indexList<=elemsSelected.length-1?EliminarItem(elemsSelected[indexList],a):(i=!0,o=e.titulomsje)):"single"==a&&(i=!0,o=e.titulomsje)),i&&(createSnackbar(o),$(".actionbar").hasClass("is-visible")&&$(".back-button").trigger("click"))},error:function(t){console.log(t)}})}$(function(){$("#gvDatos").on("click",".mdl-button",function(t){t.preventDefault();var a=this.getAttribute("data-action"),e=getParentsUntil(this,"#gvDatos",".dato");if("edit"==a){var o=e[0].getAttribute("data-id");GetDataById(o)}else MessageBox({content:"Â¿Desea eliminar el tipo de comprobante?",width:"320px",height:"130px",buttons:[{primary:!0,content:"Eliminar",onClickButton:function(t){EliminarItem(e[0],"single")}}],cancelButton:!0})}),$("#btnNuevo").on("click",function(t){t.preventDefault(),GetDataById("0")}),$("#btnGuardar").on("click",function(t){t.preventDefault(),GuardarDatos()}),$("#btnLimpiar").on("click",function(t){t.preventDefault(),LimpiarForm()}),$("#txtNombre").on("keydown",function(t){if(t.keyCode==$.ui.keyCode.ENTER)return $("#txtDescripcion").focus(),!1}),MostrarDatos()});