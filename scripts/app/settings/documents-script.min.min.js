function LimpiarForm(){$("#hdIdPrimary").val("0"),$("#txtNumMaxCaracteres").val(""),$("#txtCodigoSunat").val(""),$("#txtDescripcion").val("").focus()}function addValidForm(){$("#txtDescripcion").rules("add",{required:!0,maxlength:100}),$("#txtNumMaxCaracteres").rules("add",{required:!0,maxlength:11}),$("#txtCodigoSunat").rules("add",{required:!0,maxlength:4})}function GuardarDatos(){$("#form1").submit()}function limpiarSeleccionados(){$(".listview .selected").removeClass("selected"),$(".listview .list input:checkbox").removeAttr("checked")}function MostrarDatos(){$.ajax({url:"services/documentos/documentos-search.php",type:"GET",dataType:"json"}).done(function(e){var t=0,a=e.length,o="";for(t=0;t<a;t++)o+='<a href="#" class="list dato" data-id="'+e[t].tm_iddocident+'">',o+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+e[t].tm_iddocident+'" />',o+='<div class="list-content">',o+='<div class="data">',o+="<h2>"+e[t].tm_descripcion+"</h2>",o+="</div></div></a>";$(".listview").html(o)}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}function EnviarDatos(form){$.ajax({type:"POST",url:"services/documentos/documentos-post.php",cache:!1,data:$(form).serialize()+"&btnGuardar=btnGuardar",success:function(data){datos=eval("("+data+")"),Number(datos.rpta)>0&&MessageBox("Datos guardados","La operaci&oacute;n se complet&oacute; correctamente.","[Aceptar]",function(){limpiarSeleccionados(),resetForm("form1"),closeCustomModal("#modalRegistro"),MostrarDatos(),$("#btnEditar, #btnEliminar, #btnLimpiarSeleccion").addClass("oculto"),$("#btnNuevo").removeClass("oculto")})}})}function Eliminar(){var serializedReturn=$("#form1 input[type!=text]").serialize()+"&btnEliminar=btnEliminar";precargaExp(".page-region",!0),$.ajax({type:"POST",url:"services/documentos/documentos-post.php",cache:!1,data:serializedReturn,success:function(data){var titleMensaje="",contentMensaje="",datos=eval("("+data+")"),validItems=datos.items_valid,countValidItems=validItems.length;precargaExp(".page-region",!1),Number(datos.rpta)>0?countValidItems>0?(titleMensaje="Items eliminados correctamente",contentMensaje='Algunos items no se eliminaron. Click en "Aceptar" para ver detalle.'):(titleMensaje="Items eliminados correctamente",contentMensaje="La operaci&oacute;n ha sido completada"):(titleMensaje="No se pudo eliminar",contentMensaje="La operaci&oacute;n no pudo completarse"),MessageBox(titleMensaje,contentMensaje,"[Aceptar]",function(){var e=validItems.split(","),t=$(".listview .list.selected"),a=t.length,o=0,n=0,i="";if(countValidItems>0){for($(".error-list").html("");o<a;)n=t[o].getAttribute("rel"),e.indexOf(n)>=0?(i+='<div class="notification warning">',i+='<aside><i class="fa fa-warning"></i></aside>',i+="<main><p><strong>Error en item con ID: "+$(t[o]).find(".list-status span.label").text()+"</strong>",i+="El item no pudo ser eliminado por tener referencia con otras operaciones realizadas.</p></main>",i+="</div>"):$(t[o]).fadeOut(400,function(){$(this).remove()}),++o;$(".error-list").html(i),$("#modalItemsError").show(),$.fn.custombox({url:"#modalItemsError",effect:"slit"})}else datos.rpta>0&&t.fadeOut(400,function(){$(this).remove()})})}})}function GetDataById(e){$.ajax({url:"services/documentos/documentos-getdetails.php",type:"GET",dataType:"json",data:{id:e}}).done(function(e){$("#hdIdPrimary").val(e[0].tm_iddocident),$("#txtDescripcion").val(e[0].tm_descripcion),$("#txtNumMaxCaracteres").val(e[0].tm_nummaxcaracteres),$("#txtCodigoSunat").val(e[0].tm_codigosunat)}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}$(function(){$("#btnGuardar").on("click",function(e){e.preventDefault(),GuardarDatos()}),$("#btnLimpiar").on("click",function(e){e.preventDefault(),LimpiarForm()}),$("#btnEliminar").on("click",function(){return Eliminar(),!1}),$("#txtDescripcion").on("keydown",function(e){if(e.keyCode==$.ui.keyCode.ENTER)return $("#txtNumMaxCaracteres").focus(),!1}),$("#txtNumMaxCaracteres").on("keydown",function(e){if(e.keyCode==$.ui.keyCode.ENTER)return $("#txtCodigoSunat").focus(),!1}),$("#txtCodigoSunat").on("keydown",function(e){if(e.keyCode==$.ui.keyCode.ENTER)return $("#btnGuardar").focus(),!1}),$("#btnLimpiarSeleccion").on("click",function(e){e.preventDefault(),limpiarSeleccionados(),$("#btnEditar, #btnEliminar, #btnLimpiarSeleccion").addClass("oculto"),$("#btnNuevo").removeClass("oculto")}),$("#btnEditar").on("click",function(e){var t=$(".listview a.list.selected").attr("data-id");e.preventDefault(),openCustomModal("#modalRegistro"),GetDataById(t)}),$("#btnNuevo").on("click",function(e){e.preventDefault(),LimpiarForm(),openCustomModal("#modalRegistro")}),$("#form1").validate({lang:"es",showErrors:showErrorsInValidate,submitHandler:EnviarDatos}),addValidForm(),MostrarDatos()});