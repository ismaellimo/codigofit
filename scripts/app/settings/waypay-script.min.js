function LimpiarForm(){$("#hdIdPrimary").val("0"),$("#txtDescripcion").val(""),$("#txtCodigoSunat").val(""),$("#txtNombre").val("").focus()}function MostrarDatos(){$.ajax({url:"services/formapago/formapago-search.php",type:"GET",dataType:"json",success:function(t){var a=0,o=t.length,e="";if(o>0)for(;a<o;)e+='<li class="mdl-list__item dato pos-rel" data-id="'+t[a].tm_idformapago+'">',e+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+t[a].tm_idformapago+'" />',e+='<span class="mdl-list__item-primary-content">'+t[a].tm_nombre+"</span>",e+='<div class="grouped-buttons place-bottom-right padding5 margin5"><a class="padding5 mdl-button mdl-button--icon tooltipped" href="#" data-action="edit" data-delay="50" data-position="bottom" data-tooltip="Editar"><i class="material-icons">&#xE254;</i></a><a class="padding5 mdl-button mdl-button--icon tooltipped" href="#" data-action="delete" data-delay="50" data-position="bottom" data-tooltip="Eliminar"><i class="material-icons">&#xE872;</i></a></div>',e+="</li>",++a;else e="<h2>No se encontraron registros</h2>";$("#gvDatos .gridview").html(e)},error:function(t){console.log(t)}})}function GuardarDatos(){var t=new FormData,a=$("#modalRegistro :input").serializeArray();t.append("btnGuardar","btnGuardar"),Array.prototype.forEach.call(a,function(a){t.append(a.name,a.value)}),$.ajax({type:"POST",url:"services/formapago/formapago-post.php",cache:!1,contentType:!1,processData:!1,data:t,dataType:"json",success:function(t){createSnackbar(t.titulomsje),"0"!=t.rpta&&(closeCustomModal("#modalRegistro"),MostrarDatos())},error:function(t){console.log(t)}})}function GetDataById(t){LimpiarForm(),openModalCallBack("#modalRegistro",function(){"0"!=t&&$.ajax({url:"services/formapago/formapago-getdetails.php",type:"GET",dataType:"json",data:{tipobusqueda:"2",id:t},success:function(t){t.length>0&&($("#hdIdPrimary").val(t[0].tm_idformapago),$("#txtNombre").val(t[0].tm_nombre),$("#txtDescripcion").val(t[0].tm_descripcion),$("#txtCodigoSunat").val(t[0].CodigoSunat),$("#txtAbreviatura").val(t[0].Abreviatura),Materialize.updateTextFields())},error:function(t){console.log(t)}})})}function EliminarItem(t,a){var o=new FormData,e=t.getAttribute("data-id");o.append("btnEliminar","btnEliminar"),o.append("hdIdPrimary",e),$.ajax({type:"POST",url:"services/formapago/formapago-post.php",cache:!1,contentType:!1,processData:!1,dataType:"json",data:o,success:function(o){var e="",i=!1;"0"==o.rpta?(i=!0,e="No se puede eliminar"):($(t).fadeOut(400,function(){$(this).remove(),0==$("#gvDatos .dato").length&&$("#gvDatos .gridview").html("<h2>No se encontraron registros</h2>")}),"multiple"==a?(++indexList,indexList<=elemsSelected.length-1?EliminarItem(elemsSelected[indexList],a):(i=!0,e=o.titulomsje)):"single"==a&&(i=!0,e=o.titulomsje)),i&&(createSnackbar(e),$(".actionbar").hasClass("is-visible")&&$(".back-button").trigger("click"))},error:function(t){console.log(t)}})}$(function(){$("#gvDatos").on("click",".mdl-button",function(t){t.preventDefault();var a=this.getAttribute("data-action"),o=getParentsUntil(this,"#gvDatos",".dato");if("edit"==a){var e=o[0].getAttribute("data-id");GetDataById(e)}else MessageBox({content:"Â¿Desea eliminar el tipo de comprobante?",width:"320px",height:"130px",buttons:[{primary:!0,content:"Eliminar",onClickButton:function(t){EliminarItem(o[0],"single")}}],cancelButton:!0})}),$("#btnNuevo").on("click",function(t){t.preventDefault(),GetDataById("0")}),$("#btnGuardar").on("click",function(t){t.preventDefault(),GuardarDatos()}),$("#btnLimpiar").on("click",function(t){t.preventDefault(),LimpiarForm()}),$("#txtNombre").on("keydown",function(t){if(t.keyCode==$.ui.keyCode.ENTER)return $("#txtDescripcion").focus(),!1}),$("#txtDescripcion").on("keydown",function(t){if(t.keyCode==$.ui.keyCode.ENTER)return $("#txtCodigoSunat").focus(),!1}),$("#txtCodigoSunat").on("keydown",function(t){if(t.keyCode==$.ui.keyCode.ENTER)return $("#btnGuardar").focus(),!1}),MostrarDatos()});