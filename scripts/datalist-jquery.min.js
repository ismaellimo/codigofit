!function(e,t){"use strict";function s(e){return e.scrollTop?e.scrollTop:e.pageYOffset}var i=function(){},n={typeview:"gridview",containerData:".gridview-content",actionbar:"#generic-actionbar",selectorItem:".dato",selectedClass:".selected",onSearch:i,onSelectItem:i,onSelectAll:i,onSelectClear:i,oneItemClick:i,onInitSelecting:i},o=function(e,t){this.container=e,"string"==typeof e&&(this.container=$(e));var s=$.extend({},n,t);this.settings=s,this.actionbar=s.actionbar,this.selectedClass=s.selectedClass,this.startTime,this.endTime,this.longpress=!1,this.isScroll=!1,this.timeoutScroll=null,this.delayScroll=200,this.current_page=1,this._attachDataListEvents()};o.prototype.getContainer=function(){return this.container},o.prototype._attachDataListEvents=function(){var e,t=this,s=t.container,i=t.settings.typeview,n=t.settings.selectorItem,o="undefined"==typeof t.settings.withDefaultEvents||t.settings.withDefaultEvents;if("checklist"==i&&(s.addClass("list-checkbox"),n+=' input[type="checkbox"]'),o){var c=function(e){var i=getParentsUntil(this,"#"+s.id,t.settings.selectorItem);$(i[0]).toggleClass(t.selectedClass.substr(1));var n=s.find(t.selectedClass);"undefined"!=typeof n&&n.length>0?1==n.length&&t.showAppBar(!0,"edit"):t.showAppBar(!1,"edit")},a=function(e){e.preventDefault();var s=this,i=t.selectedClass;t.container.hasClass("custom")?t.settings.oneItemClick(e):("touchend"==e.type&&(t.endTime=(new Date).getTime(),t.longpress=!(t.endTime-t.startTime<300)),t.isScroll===!1&&(t.longpress?(t.showAppBar(!0,"edit"),t._setSelecting("true","some"),t._selectElement(s,i),t.settings.onInitSelecting(e)):"true"==t.container.attr("data-multiselect")?t._selectElement(s,i):t.settings.oneItemClick(e)))};e="checklist"==i?c:a,this.container.on("click touchend",n,e),"gridview"==i&&(this.container.on("mousedown touchstart",n,function(e){t.startTime=(new Date).getTime()}),this.container.on("mouseup",n,function(e){t.endTime=(new Date).getTime(),t.longpress=!(t.endTime-t.startTime<300)}))}else this.container.on("click touchend",n,function(e){t.settings.oneItemClick(e)})},o.prototype.listenerScroll=function(e,t){var i=this;i.isScroll=!0,clearTimeout(i.timeoutScroll),i.timeoutScroll=setTimeout(function(){i.isScroll=!1},i.delayScroll);var n=getStyle(e,"height");s(e)+Number(n.replace("px",""))>=e.scrollHeight&&i.settings.onSearch()},o.prototype._setSelecting=function(e,t){this.container.attr("data-multiselect",e),this.container.attr("data-selected",t)},o.prototype._selectElement=function(e,t){var s=$(e),i=e.querySelector('input[type="checkbox"]'),n=t.substr(1);if(s.hasClass(n)){s.removeClass(n),i.checked=!1;var o=this.container.find(t);0==o.length?this.container.hasClass("custom")||(this.showAppBar(!1,"edit"),this._setSelecting("false","none"),this.settings.onSelectClear()):o=this.container.find(t)}else s.addClass(n),i.checked=!0},o.prototype._checkCheckList=function(e,t){var s=e.find('input[type="checkbox"]');[].forEach.call(s,function(e){e.checked=t})},o.prototype.selectAll=function(e){var t=this.container.find(this.settings.selectorItem);"undefined"!=typeof t&&(this.showAppBar(!0,"edit"),this._setSelecting("true","all"),t.addClass(this.selectedClass.substr(1)),this._checkCheckList(this.container,!0),"undefined"!=typeof e&&e())},o.prototype.removeSelection=function(e){var t=this.container.find(this.selectedClass);"undefined"!=typeof t&&(t.removeClass(this.selectedClass.substr(1)),this._checkCheckList(this.container,!1),this.showAppBar(!1,"visible"),this._setSelecting("false","none"),"undefined"!=typeof e&&e())},o.prototype.currentPage=function(e){return"undefined"==typeof e?this.current_page:void(this.current_page=e)},o.prototype.showAppBar=function(e,t){if("undefined"!=typeof this.actionbar){var s=this.container,i=this.actionbar;"string"==typeof i&&(i=$(this.actionbar)),null!=i?e?(i.removeClass("edit search").addClass("is-visible "+t),s.addClass(t),"search"!=t&&s.addClass("prepare-multiselect")):(s.removeClass("prepare-multiselect "+t),i.removeClass("is-visible "+t)):e?s.addClass("prepare-multiselect"):s.removeClass("prepare-multiselect "+t)}},"function"==typeof define&&define.amd?define([],function(){return o}):"object"==typeof exports?module.exports=o:e.DataList=o}(window,document);